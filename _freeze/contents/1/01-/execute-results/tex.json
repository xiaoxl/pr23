{
  "hash": "e0ae8088e49e161884005d21da276687",
  "result": {
    "markdown": "# Preliminaries \n\n## Why Python?\n### Python is easy to learn and use\n<!-- Programmers familiar with traditional languages will find it easy to learn Python. All of the familiar constructs—loops, conditional statements, arrays, and so forth—are included, but many are easier to use in Python. Here are a few of the reasons why:\n\n- Types are associated with objects, not variables. A variable can be assigned a value of any type, and a list can contain objects of many types. This also means that type casting usually isn’t necessary and that your code isn’t locked into the straitjacket of predeclared types.\n\n- Python typically operates at a much higher level of abstraction. This is partly the result of the way the language is built and partly the result of an extensive standard code library that comes with the Python distribution. A program to download a web page can be written in two or three lines!\n\n- Syntax rules are very simple. Although becoming an expert Pythonista takes time\nand effort, even beginners can absorb enough Python syntax to write useful\ncode quickly.\n\nPython is well suited for rapid application development. It isn’t unusual for coding an application in Python to take one-fifth the time it would in C or Java and to take as little as one-fifth the number of lines of the equivalent C program. This depends on the particular application, of course; for a numerical algorithm performing mostly integer arithmetic in for loops, there would be much less of a productivity gain. For the average application, the productivity gain can be significant.  -->\n### Python is easy to read\n### Python Community is mature and supportive\n\n\n\n\n\n\n\n\n## Hello world!\n\n\n<!-- \nWe will mainly focus on this code editor mode at the beginning and check our results or do some simple computations in the console.\n\nNotebook is another very popular mode to use Python. We will talk about it later.\n\n -->\n\n\n### Setup the Python environment\n\nIn this section we are going to setup the Python developing environment.\n\n#### VS Code + Anaconda\nClick [Appendix -@sec-vscode] to see the detailed steps for VS Code and Anaconda. You may also check out [the official document](https://code.visualstudio.com/docs/languages/python). It contains more features but less details.\n\nWe will talk about the relation between Python and Anaconda and more about packages sometime later.\n\n#### Google Colab\nClick [Appendix -@sec-googlecolab] for more details.\n\n\n### `Hello World!`\n\n\n<!-- 5. Here are the steps to edit the system environment variables. First in the start menu search for `Edit the system environment variables`. \n\n![](assests/img/20220817235031.png){fig-align=\"center\"}\n\nThen click the `Environment Variables...` button at the right lower corner. \n\n![](assests/img/20220817235002.png){fig-align=\"center\"} \n\nFind the `Path` variable in either the upper window or the lower window. Use which one depends on whether you want to register the variable for the user or for the machine. In this example I add for the user.\n\nFinally double click the variable and add the following path to it. You need to make changes according to your installation. I recommend you to locate your Anaconda installation first to get the path.\n\n![](assests/img/20220817233748.png){fig-align=\"center\"} -->\n\nTake VS Code as an example. In the editor window, type in the code, and run the file in the interactive window.\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nprint('Hello World!')\n```\n:::\n\n\n![](assests/img/20220817235844.png){fig-align=\"center\"}  \n\nIf you see a small green check mark in the interactive window and also the output `Hello World!`, you are good to go!\n\n### Python code cells and Notebooks\nIn VS Code you can run codes cell by cell. Each cell is separated by the symbol `# %%`. Each cell may contain multiple lines. You may click the small button on top of the cell or use keybindings.\n\n![](assests/img/20220818000531.png){fig-align=\"center\"}  \n\nThis feature actually mimic the notebook. We may start a real Python Notebook file by directly creating a file with extension `.ipynb`. \n\n![](assests/img/20220818000752.png){fig-align=\"center\"}\n\nThe layout is straightforward. \n\n\n### Linters\n\n<!-- go here @sec-vscode -->\n\n<!-- \n### Linters\nA *linter* is a tool to help you improve your code by analyzing your source code looking for problems. Some popular choices for Python includes `Flake8` and `Pylint`. It is highly recommended to use one that is compatible with your IDE which can help you to increase the quality of your codes from the begining. -->\n\n\n\n### IPython and Jupyter\n<!-- The IPython project began in 2001 as Fernando Pérez’s side project to make a better\ninteractive Python interpreter. In the subsequent 16 years it has become one of the\nmost important tools in the modern Python data stack. While it does not provide any\ncomputational or data analytical tools by itself, IPython is designed from the ground\nup to maximize your productivity in both interactive computing and software devel‐\nopment. It encourages an execute-explore workflow instead of the typical edit-compile-\nrun workflow of many other programming languages. It also provides easy access to\nyour operating system’s shell and filesystem. Since much of data analysis coding\ninvolves exploration, trial and error, and iteration, IPython can help you get the job\ndone faster.\nIn 2014, Fernando and the IPython team announced the Jupyter project, a broader\ninitiative to design language-agnostic interactive computing tools. The IPython web\nnotebook became the Jupyter notebook, with support now for over 40 programming\nlanguages. The IPython system can now be used as a kernel (a programming language\nmode) for using Python with Jupyter.\nIPython itself has become a component of the much broader Jupyter open source\nproject, which provides a productive environment for interactive and exploratory\ncomputing. Its oldest and simplest “mode” is as an enhanced Python shell designed to\naccelerate the writing, testing, and debugging of Python code. You can also use the\nIPython system through the Jupyter Notebook, an interactive web-based code “note‐\nbook” offering support for dozens of programming languages. The IPython shell and\nJupyter notebooks are especially useful for data exploration and visualization.\nThe Jupyter notebook system also allows you to author content in Markdown and\nHTML, providing you a means to create rich documents with code and text. Other\nprogramming languages have also implemented kernels for Jupyter to enable you to\nuse languages other than Python in Jupyter.\nFor me personally, IPython is usually involved with the majority of my Python work,\nincluding running, debugging, and testing code.\nIn the accompanying book materials, you will find Jupyter notebooks containing all\nthe code examples from each chapter. -->\n\n<!-- \n## Exercises\nMost problems are based on @Sha2017, @You2020 and @Swe2020.\n -->\n\n\n## Projects\n\n\n::: {#exr-}\n## Hello world!\n\nPlease set up a Python developing environment, including for `.py` file and for notebook, that will be used across the semester. Then print `Hello World!`.\n:::\n\n\n\n::: {#exr-}\n## Define a function and play with `time`\nPlease play with the following codes in a Jupyter notebook. We haven't talked about any of them right now. Try to guess what they do and write your guess in markdown cells.\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\nimport time\n\ndef multistr(x, n=2):\n    return x * n\n\nt0 = time.time()\nx = 'Python'\nprint(multistr(x, n=10))\nt1 = time.time()\nprint(\"Time used: \", t1-t0)\n```\n:::\n\n\n:::\n\n\n\n\n::: {#exr-}\n## Fancy Basketball plot\nHere is an example of the data analysis. We pull data from a dataset, filter the data according to our needs and plot it to visualize the data. This is just a show case. You are encouraged to play the code, make tweaks and see what would happen. You don't have to turn in anything.\n\nThe data we choose is Stephen Curry's shots data in 2021-2022 regular season. First we need to load the data. The data is obtained from `nba.com` using `nba_api`.\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\nfrom nba_api.stats.static import players\nfrom nba_api.stats.endpoints import shotchartdetail\nplayer_dict = players.get_players()\n```\n:::\n\n\nThe shots data we need is in `shotchartdetail`. However to use it we need to know the id of `Stephen Curry` using the dataset `player_dict`.\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\nfor player in player_dict:\n    if player['full_name'] == 'Stephen Curry':\n        print(player['id'])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n201939\n```\n:::\n:::\n\n\nSo the id of `Stephen Curry` is `201939`. Let's pull out his shots data in 2021-2022 season. \n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\nresults = shotchartdetail.ShotChartDetail(\n            team_id = 0,\n            player_id = 201939,\n            context_measure_simple = 'FGA',\n            season_nullable = '2021-22',\n            season_type_all_star = 'Regular Season')\ndf = results.get_data_frames()[0]\ndf.head()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nC:\\Users\\Xinli\\AppData\\Roaming\\Python\\Python310\\site-packages\\IPython\\core\\formatters.py:343: FutureWarning: In future versions `DataFrame.to_latex` is expected to utilise the base implementation of `Styler.to_latex` for formatting and rendering. The arguments signature may therefore change. It is recommended instead to use `DataFrame.style.to_latex` which also contains additional functionality.\n  return method()\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=tex}\n\\begin{tabular}{lllrrlrlrrrllllllrrrrrlll}\n\\toprule\n{} &          GRID\\_TYPE &     GAME\\_ID &  GAME\\_EVENT\\_ID &  PLAYER\\_ID &    PLAYER\\_NAME &     TEAM\\_ID &              TEAM\\_NAME &  PERIOD &  MINUTES\\_REMAINING &  SECONDS\\_REMAINING &   EVENT\\_TYPE &                     ACTION\\_TYPE &       SHOT\\_TYPE &    SHOT\\_ZONE\\_BASIC &        SHOT\\_ZONE\\_AREA &  SHOT\\_ZONE\\_RANGE &  SHOT\\_DISTANCE &  LOC\\_X &  LOC\\_Y &  SHOT\\_ATTEMPTED\\_FLAG &  SHOT\\_MADE\\_FLAG & GAME\\_DATE &  HTM &  VTM \\\\\n\\midrule\n0 &  Shot Chart Detail &  0022100002 &             26 &     201939 &  Stephen Curry &  1610612744 &  Golden State Warriors &       1 &                 10 &                  9 &  Missed Shot &                Pullup Jump shot &  3PT Field Goal &  Above the Break 3 &  Left Side Center(LC) &          24+ ft. &             28 &   -109 &    260 &                    1 &               0 &  20211019 &  LAL &  GSW \\\\\n1 &  Shot Chart Detail &  0022100002 &             34 &     201939 &  Stephen Curry &  1610612744 &  Golden State Warriors &       1 &                  9 &                 41 &  Missed Shot &       Running Pull-Up Jump Shot &  3PT Field Goal &  Above the Break 3 &             Center(C) &          24+ ft. &             26 &     48 &    257 &                    1 &               0 &  20211019 &  LAL &  GSW \\\\\n2 &  Shot Chart Detail &  0022100002 &             37 &     201939 &  Stephen Curry &  1610612744 &  Golden State Warriors &       1 &                  9 &                 10 &    Made Shot &                       Jump Shot &  3PT Field Goal &  Above the Break 3 &  Left Side Center(LC) &          24+ ft. &             25 &   -165 &    189 &                    1 &               1 &  20211019 &  LAL &  GSW \\\\\n3 &  Shot Chart Detail &  0022100002 &             75 &     201939 &  Stephen Curry &  1610612744 &  Golden State Warriors &       1 &                  6 &                 17 &  Missed Shot &  Driving Finger Roll Layup Shot &  2PT Field Goal &    Restricted Area &             Center(C) &  Less Than 8 ft. &              1 &    -13 &     12 &                    1 &               0 &  20211019 &  LAL &  GSW \\\\\n4 &  Shot Chart Detail &  0022100002 &            130 &     201939 &  Stephen Curry &  1610612744 &  Golden State Warriors &       1 &                  3 &                 11 &  Missed Shot &                      Layup Shot &  2PT Field Goal &    Restricted Area &             Center(C) &  Less Than 8 ft. &              2 &    -15 &     22 &                    1 &               0 &  20211019 &  LAL &  GSW \\\\\n\\bottomrule\n\\end{tabular}\n```\n:::\n:::\n\n\n`df` is the results we get in terms of a `DataFrame`, and we show the first `5` records as an example. \n\nThese are all attempts. We are interested in all made. By looking at all the columns, we find a column called `SHOT_MADE_FLAG` which shows what we want. Therefore we will use it to filter the records.\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\ndf_made = df[df['SHOT_MADE_FLAG']==1]\ndf_made.head()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nC:\\Users\\Xinli\\AppData\\Roaming\\Python\\Python310\\site-packages\\IPython\\core\\formatters.py:343: FutureWarning: In future versions `DataFrame.to_latex` is expected to utilise the base implementation of `Styler.to_latex` for formatting and rendering. The arguments signature may therefore change. It is recommended instead to use `DataFrame.style.to_latex` which also contains additional functionality.\n  return method()\n```\n:::\n\n::: {.cell-output .cell-output-display execution_count=4}\n```{=tex}\n\\begin{tabular}{lllrrlrlrrrllllllrrrrrlll}\n\\toprule\n{} &          GRID\\_TYPE &     GAME\\_ID &  GAME\\_EVENT\\_ID &  PLAYER\\_ID &    PLAYER\\_NAME &     TEAM\\_ID &              TEAM\\_NAME &  PERIOD &  MINUTES\\_REMAINING &  SECONDS\\_REMAINING & EVENT\\_TYPE &                     ACTION\\_TYPE &       SHOT\\_TYPE &    SHOT\\_ZONE\\_BASIC &        SHOT\\_ZONE\\_AREA &  SHOT\\_ZONE\\_RANGE &  SHOT\\_DISTANCE &  LOC\\_X &  LOC\\_Y &  SHOT\\_ATTEMPTED\\_FLAG &  SHOT\\_MADE\\_FLAG & GAME\\_DATE &  HTM &  VTM \\\\\n\\midrule\n2  &  Shot Chart Detail &  0022100002 &             37 &     201939 &  Stephen Curry &  1610612744 &  Golden State Warriors &       1 &                  9 &                 10 &  Made Shot &                       Jump Shot &  3PT Field Goal &  Above the Break 3 &  Left Side Center(LC) &          24+ ft. &             25 &   -165 &    189 &                    1 &               1 &  20211019 &  LAL &  GSW \\\\\n6  &  Shot Chart Detail &  0022100002 &            176 &     201939 &  Stephen Curry &  1610612744 &  Golden State Warriors &       1 &                  0 &                 27 &  Made Shot &  Driving Finger Roll Layup Shot &  2PT Field Goal &    Restricted Area &             Center(C) &  Less Than 8 ft. &              2 &     -7 &     29 &                    1 &               1 &  20211019 &  LAL &  GSW \\\\\n9  &  Shot Chart Detail &  0022100002 &            352 &     201939 &  Stephen Curry &  1610612744 &  Golden State Warriors &       2 &                  1 &                 29 &  Made Shot &                      Layup Shot &  2PT Field Goal &    Restricted Area &             Center(C) &  Less Than 8 ft. &              1 &     -1 &     10 &                    1 &               1 &  20211019 &  LAL &  GSW \\\\\n16 &  Shot Chart Detail &  0022100002 &            510 &     201939 &  Stephen Curry &  1610612744 &  Golden State Warriors &       3 &                  2 &                 23 &  Made Shot &              Cutting Layup Shot &  2PT Field Goal &    Restricted Area &             Center(C) &  Less Than 8 ft. &              1 &      7 &      8 &                    1 &               1 &  20211019 &  LAL &  GSW \\\\\n18 &  Shot Chart Detail &  0022100002 &            642 &     201939 &  Stephen Curry &  1610612744 &  Golden State Warriors &       4 &                  5 &                 34 &  Made Shot &                       Jump Shot &  3PT Field Goal &  Above the Break 3 &             Center(C) &          24+ ft. &             26 &     48 &    260 &                    1 &               1 &  20211019 &  LAL &  GSW \\\\\n\\bottomrule\n\\end{tabular}\n```\n:::\n:::\n\n\nWe also notice that there are two columns `LOC_X` and `LOC_Y` shows the coordinates of the attempts. We will use it to draw the heatmap. The full code for drawing out the court `draw_court` is folded below. It is from [Bradley Fay GitHub](https://github.com/bradleyfay/py-Goldsberry/blob/master/docs/Visualizing%20NBA%20Shots%20with%20py-Goldsberry.ipynb). \n\n\n::: {.callout-note}\nNote that, although `draw_cort` is long, it is not hard to understand. It just draws a court piece by piece.\n:::\n\n::: {.cell execution_count=7}\n``` {.python .cell-code code-fold=\"true\"}\nfrom matplotlib.patches import Circle, Rectangle, Arc\nimport matplotlib.pyplot as plt\n\n\ndef draw_court(ax=None, color='gray', lw=1, outer_lines=False):\n    \"\"\"\n    Returns an axes with a basketball court drawn onto to it.\n\n    This function draws a court based on the x and y-axis values that the NBA\n    stats API provides for the shot chart data.  For example, the NBA stat API\n    represents the center of the hoop at the (0,0) coordinate.  Twenty-two feet\n    from the left of the center of the hoop in is represented by the (-220,0)\n    coordinates.  So one foot equals +/-10 units on the x and y-axis.\n    \"\"\"\n    if ax is None:\n        ax = plt.gca()\n\n    # Create the various parts of an NBA basketball court\n\n    # Create the basketball hoop\n    hoop = Circle((0, 0), radius=7.5, linewidth=lw, color=color, fill=False)\n\n    # Create backboard\n    backboard = Rectangle((-30, -7.5), 60, -1, linewidth=lw, color=color)\n\n    # The paint\n    # Create the outer box 0f the paint, width=16ft, height=19ft\n    outer_box = Rectangle((-80, -47.5), 160, 190, linewidth=lw, color=color,\n                          fill=False)\n    # Create the inner box of the paint, widt=12ft, height=19ft\n    inner_box = Rectangle((-60, -47.5), 120, 190, linewidth=lw, color=color,\n                          fill=False)\n\n    # Create free throw top arc\n    top_free_throw = Arc((0, 142.5), 120, 120, theta1=0, theta2=180,\n                         linewidth=lw, color=color, fill=False)\n    # Create free throw bottom arc\n    bottom_free_throw = Arc((0, 142.5), 120, 120, theta1=180, theta2=0,\n                            linewidth=lw, color=color, linestyle='dashed')\n    # Restricted Zone, it is an arc with 4ft radius from center of the hoop\n    restricted = Arc((0, 0), 80, 80, theta1=0, theta2=180, linewidth=lw,\n                     color=color)\n\n    # Three point line\n    # Create the right side 3pt lines, it's 14ft long before it arcs\n    corner_three_a = Rectangle((-220, -47.5), 0, 140, linewidth=lw,\n                               color=color)\n    # Create the right side 3pt lines, it's 14ft long before it arcs\n    corner_three_b = Rectangle((220, -47.5), 0, 140, linewidth=lw, color=color)\n    # 3pt arc - center of arc will be the hoop, arc is 23'9\" away from hoop\n    three_arc = Arc((0, 0), 475, 475, theta1=22, theta2=158, linewidth=lw,\n                    color=color)\n\n    # Center Court\n    center_outer_arc = Arc((0, 422.5), 120, 120, theta1=180, theta2=0,\n                           linewidth=lw, color=color)\n    center_inner_arc = Arc((0, 422.5), 40, 40, theta1=180, theta2=0,\n                           linewidth=lw, color=color)\n\n    # List of the court elements to be plotted onto the axes\n    court_elements = [hoop, backboard, outer_box, inner_box, top_free_throw,\n                      bottom_free_throw, restricted, corner_three_a,\n                      corner_three_b, three_arc, center_outer_arc,\n                      center_inner_arc]\n\n    if outer_lines:\n        # Draw the half court line, baseline and side out bound lines\n        outer_lines = Rectangle((-250, -47.5), 500, 470, linewidth=lw,\n                                color=color, fill=False)\n        court_elements.append(outer_lines)\n\n    # Add the court elements onto the axes\n    for element in court_elements:\n        ax.add_patch(element)\n\n    return ax\n```\n:::\n\n\n::: {.cell execution_count=8}\n``` {.python .cell-code}\n# Create figure and axes\nfig = plt.figure(figsize=(6, 6))\nax = fig.add_axes([0, 0, 1, 1])\n\n# Plot hexbin of shots\nax.hexbin(df['LOC_X'], df['LOC_Y'], gridsize=(30, 30), extent=(-300, 300, 0, 940), bins='log', cmap='Blues')\nax = draw_court(ax, 'black')\n\n# Annotate player name and season\nax.text(0, 1.05, 'Stephen Curry\\n2021-22 Regular Season', transform=ax.transAxes, ha='left', va='baseline')\n\n# Set axis limits\n_ = ax.set_xlim(-250, 250)\n_ = ax.set_ylim(0, 400)\n```\n\n::: {.cell-output .cell-output-display}\n![](01-_files/figure-pdf/cell-9-output-1.pdf){fig-pos='H'}\n:::\n:::\n\n\n:::\n\n\n<details>\n<summary>Click for Hint.</summary>\n\n::: {.solution}\n## Hint\n\n::: {.cell execution_count=9}\n``` {.python .cell-code}\nfrom nba_api.stats.static import players\nfrom nba_api.stats.endpoints import shotchartdetail\nplayer_dict = players.get_players()\n```\n:::\n\n\nThese lines import some packages and get player information and save them into `player_dict`.\n\n::: {.cell execution_count=10}\n``` {.python .cell-code}\nfor player in player_dict:\n    if player['full_name'] == 'Stephen Curry':\n        print(player['id'])\n```\n:::\n\n\nGo through all records in `player_dict`. If the name of a player is `Stephen Curry`, get his `id`. Then we will know the `id` of `Stephen Curry`.\n\n*To be omitted.*\n:::\n</details>\n\n",
    "supporting": [
      "01-_files\\figure-pdf"
    ],
    "filters": []
  }
}