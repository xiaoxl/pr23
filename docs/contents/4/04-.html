<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Python/R for Data Science - 4&nbsp; Package: pandas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../contents/5/05-.html" rel="next">
<link href="../../contents/3/03-.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Python/R for Data Science</span>
    </a>
  </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Package: <code>pandas</code></span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Part I: Python</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/1/01-.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preliminaries</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/2/02-.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Python Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/3/03-.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Package: <code>numpy</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/4/04-.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Package: <code>pandas</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/5/05-.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/6/06-.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Classes/Packages for Python</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Part II: R</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/7/07-.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">R Fundamentals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/8/08-.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">R for Data Sciences</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Appendices</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/app/setup.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/app/path.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title"><code>PATH</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/app/virtenv.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Package management</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/app/concepts.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Some Hard Python concepts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/app/r.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Using R in VS Code</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#basic-pandas" id="toc-basic-pandas" class="nav-link active" data-scroll-target="#basic-pandas"><span class="toc-section-number">4.1</span>  Basic <code>pandas</code></a>
  <ul class="collapse">
  <li><a href="#series-and-dataframe" id="toc-series-and-dataframe" class="nav-link" data-scroll-target="#series-and-dataframe"><span class="toc-section-number">4.1.1</span>  <code>Series</code> and <code>DataFrame</code></a></li>
  <li><a href="#accessing-data" id="toc-accessing-data" class="nav-link" data-scroll-target="#accessing-data"><span class="toc-section-number">4.1.2</span>  Accessing data</a></li>
  <li><a href="#updating-data" id="toc-updating-data" class="nav-link" data-scroll-target="#updating-data"><span class="toc-section-number">4.1.3</span>  Updating data</a></li>
  <li><a href="#indexing-selection-and-filtering" id="toc-indexing-selection-and-filtering" class="nav-link" data-scroll-target="#indexing-selection-and-filtering"><span class="toc-section-number">4.1.4</span>  Indexing, Selection, and Filtering</a></li>
  <li><a href="#essential-functions" id="toc-essential-functions" class="nav-link" data-scroll-target="#essential-functions"><span class="toc-section-number">4.1.5</span>  Essential functions</a></li>
  <li><a href="#function-application-and-mapping" id="toc-function-application-and-mapping" class="nav-link" data-scroll-target="#function-application-and-mapping"><span class="toc-section-number">4.1.6</span>  Function Application and Mapping</a></li>
  <li><a href="#sorting-and-ranking" id="toc-sorting-and-ranking" class="nav-link" data-scroll-target="#sorting-and-ranking"><span class="toc-section-number">4.1.7</span>  Sorting and Ranking</a></li>
  <li><a href="#summarizing-and-computing-descriptive-statistics" id="toc-summarizing-and-computing-descriptive-statistics" class="nav-link" data-scroll-target="#summarizing-and-computing-descriptive-statistics"><span class="toc-section-number">4.1.8</span>  Summarizing and Computing Descriptive Statistics</a></li>
  <li><a href="#unique-values-value-counts-and-membership" id="toc-unique-values-value-counts-and-membership" class="nav-link" data-scroll-target="#unique-values-value-counts-and-membership"><span class="toc-section-number">4.1.9</span>  Unique Values, Value Counts, and Membership</a></li>
  <li><a href="#reading-and-writing-data-in-text-format" id="toc-reading-and-writing-data-in-text-format" class="nav-link" data-scroll-target="#reading-and-writing-data-in-text-format"><span class="toc-section-number">4.1.10</span>  Reading and Writing Data in Text Format</a></li>
  <li><a href="#copies-and-views" id="toc-copies-and-views" class="nav-link" data-scroll-target="#copies-and-views"><span class="toc-section-number">4.1.11</span>  Copies and views</a></li>
  </ul></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning"><span class="toc-section-number">4.2</span>  Data cleaning</a>
  <ul class="collapse">
  <li><a href="#handling-missing-data" id="toc-handling-missing-data" class="nav-link" data-scroll-target="#handling-missing-data"><span class="toc-section-number">4.2.1</span>  Handling Missing Data</a></li>
  <li><a href="#data-transformation" id="toc-data-transformation" class="nav-link" data-scroll-target="#data-transformation"><span class="toc-section-number">4.2.2</span>  Data Transformation</a></li>
  <li><a href="#example-movies" id="toc-example-movies" class="nav-link" data-scroll-target="#example-movies"><span class="toc-section-number">4.2.3</span>  Example: Movies</a></li>
  <li><a href="#string-manipulation" id="toc-string-manipulation" class="nav-link" data-scroll-target="#string-manipulation"><span class="toc-section-number">4.2.4</span>  String Manipulation</a></li>
  <li><a href="#regular-expression" id="toc-regular-expression" class="nav-link" data-scroll-target="#regular-expression"><span class="toc-section-number">4.2.5</span>  Regular expression</a></li>
  </ul></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling"><span class="toc-section-number">4.3</span>  Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#hierarchical-indexing" id="toc-hierarchical-indexing" class="nav-link" data-scroll-target="#hierarchical-indexing"><span class="toc-section-number">4.3.1</span>  Hierarchical indexing</a></li>
  <li><a href="#combining-and-merging-datasets" id="toc-combining-and-merging-datasets" class="nav-link" data-scroll-target="#combining-and-merging-datasets"><span class="toc-section-number">4.3.2</span>  Combining and Merging Datasets</a></li>
  </ul></li>
  <li><a href="#data-aggregation-and-group-operations" id="toc-data-aggregation-and-group-operations" class="nav-link" data-scroll-target="#data-aggregation-and-group-operations"><span class="toc-section-number">4.4</span>  Data Aggregation and Group Operations</a>
  <ul class="collapse">
  <li><a href="#split-apply-combine-model" id="toc-split-apply-combine-model" class="nav-link" data-scroll-target="#split-apply-combine-model"><span class="toc-section-number">4.4.1</span>  split-apply-combine model</a></li>
  <li><a href="#more-aggregation-functions" id="toc-more-aggregation-functions" class="nav-link" data-scroll-target="#more-aggregation-functions"><span class="toc-section-number">4.4.2</span>  More aggregation functions</a></li>
  <li><a href="#some-examples" id="toc-some-examples" class="nav-link" data-scroll-target="#some-examples"><span class="toc-section-number">4.4.3</span>  Some examples</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="toc-section-number">4.5</span>  Exercises</a></li>
  <li><a href="#projects" id="toc-projects" class="nav-link" data-scroll-target="#projects"><span class="toc-section-number">4.6</span>  Projects</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Package: <code>pandas</code></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>The basic data structure for <code>pandas</code> is <code>pandas.DataFrame</code>. You may treat it as a generalized version of tables.</p>
<p>To use <code>pandas</code>, we just import it. In most cases you would like to use the alias <code>pd</code>.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since <code>DataFrame</code> is more like a table, the biggest questions here is not to do computations (which is still very important), but to retrieve, search, sort, merge, etc.. those data.</p>
<section id="basic-pandas" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="basic-pandas"><span class="header-section-number">4.1</span> Basic <code>pandas</code></h2>
<section id="series-and-dataframe" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="series-and-dataframe"><span class="header-section-number">4.1.1</span> <code>Series</code> and <code>DataFrame</code></h3>
<p>A <em>Series</em> is a 1-d array-like object which has index. The default index is starting from <code>0</code>. You may change the index to be something assigned by you. Thus it can be treated as a generalization of a <code>dict</code>.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>obj <span class="op">=</span> pd.Series([<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>])</span>
<span id="cb2-2"><a href="#cb2-2"></a>obj</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>0    3
1    1
2    2
3    4
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>obj2 <span class="op">=</span> pd.Series([<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>], index<span class="op">=</span>[<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>])</span>
<span id="cb4-2"><a href="#cb4-2"></a>obj2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>a    3
b    1
c    2
d    4
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>data3 <span class="op">=</span> {<span class="st">'a'</span>: <span class="dv">3</span>, <span class="st">'b'</span>: <span class="dv">1</span>, <span class="st">'c'</span>: <span class="dv">2</span>, <span class="st">'d'</span>: <span class="dv">4</span>}</span>
<span id="cb6-2"><a href="#cb6-2"></a>obj3 <span class="op">=</span> pd.Series(data3)</span>
<span id="cb6-3"><a href="#cb6-3"></a>obj3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>a    3
b    1
c    2
d    4
dtype: int64</code></pre>
</div>
</div>
<p>A <em>DataFrame</em> represents a rectangular table of data and contains an ordered collection of columns, each of which can be a different value type. The DataFrame has both a row and column index; it can be thought of as a dict of Series all sharing the same index. When displaying a DataFrame, we may use <code>.head()</code> to just display the first few rows for efficicy.</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a>data <span class="op">=</span> {<span class="st">'a'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>],</span>
<span id="cb8-4"><a href="#cb8-4"></a>        <span class="st">'b'</span>: [<span class="fl">1.1</span>, <span class="fl">2.1</span>, <span class="fl">3.1</span>, <span class="fl">4.1</span>, <span class="fl">5.1</span>, <span class="fl">6.1</span>, <span class="fl">7.1</span>],</span>
<span id="cb8-5"><a href="#cb8-5"></a>        <span class="st">'c'</span>: [<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>, <span class="st">'e'</span>, <span class="st">'f'</span>, <span class="st">'g'</span>]}</span>
<span id="cb8-6"><a href="#cb8-6"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb8-7"><a href="#cb8-7"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1.1</td>
      <td>a</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2.1</td>
      <td>b</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>3.1</td>
      <td>c</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>4.1</td>
      <td>d</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>5.1</td>
      <td>e</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We may use the setting <code>columns=</code> or <code>index=</code> as well as the methods <code>.rename(columns=, index=)</code> to change the column names and the index names. See the following example.</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb9-3"><a href="#cb9-3"></a>data <span class="op">=</span> pd.DataFrame(np.arange(<span class="dv">16</span>).reshape((<span class="dv">4</span>, <span class="dv">4</span>)),</span>
<span id="cb9-4"><a href="#cb9-4"></a>                    index<span class="op">=</span>[<span class="st">'Ohio'</span>, <span class="st">'Colorado'</span>, <span class="st">'Utah'</span>, <span class="st">'New York'</span>],</span>
<span id="cb9-5"><a href="#cb9-5"></a>                    columns<span class="op">=</span>[<span class="st">'one'</span>, <span class="st">'two'</span>, <span class="st">'three'</span>, <span class="st">'four'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</section>
<section id="accessing-data" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="accessing-data"><span class="header-section-number">4.1.2</span> Accessing data</h3>
<ul>
<li>A column in a DataFrame can be retrieved as a Series either by dict-like notation or by attribute. What one gets from this is a Series object.
<ul>
<li>dict-like notation: <code>df['a']</code></li>
<li>by attribute: <code>df.a</code>. Note that if the name of the column is not suitable for attribute names, this method doesn’t work.</li>
</ul></li>
<li>Rows are retrieved by <code>.loc</code> if using the row index, and by <code>.iloc</code> if using the row number.</li>
</ul>
</section>
<section id="updating-data" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="updating-data"><span class="header-section-number">4.1.3</span> Updating data</h3>
<ul>
<li>Assign values to a column of a DataFrame will update that column. If the column doesn’t exist, new column will be created.</li>
<li>When assign values with non-existent row index, that part of the data will be discarded.</li>
<li>Any time if there are no values with a specific column and row, it will show as <code>NaN</code>.</li>
</ul>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.1 </strong></span>&nbsp;</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb10-2"><a href="#cb10-2"></a></span>
<span id="cb10-3"><a href="#cb10-3"></a>data <span class="op">=</span> {<span class="st">'a'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>],</span>
<span id="cb10-4"><a href="#cb10-4"></a>        <span class="st">'b'</span>: [<span class="fl">1.1</span>, <span class="fl">2.1</span>, <span class="fl">3.1</span>, <span class="fl">4.1</span>],</span>
<span id="cb10-5"><a href="#cb10-5"></a>        <span class="st">'c'</span>: [<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>]}</span>
<span id="cb10-6"><a href="#cb10-6"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb10-7"><a href="#cb10-7"></a></span>
<span id="cb10-8"><a href="#cb10-8"></a>newcol <span class="op">=</span> {<span class="dv">1</span>: <span class="st">'good'</span>, <span class="dv">3</span>: <span class="st">'better'</span>, <span class="dv">5</span>: <span class="st">'best'</span>}</span>
<span id="cb10-9"><a href="#cb10-9"></a>df[<span class="st">'d'</span>] <span class="op">=</span> pd.Series(newcol)</span>
<span id="cb10-10"><a href="#cb10-10"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1.1</td>
      <td>a</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2.1</td>
      <td>b</td>
      <td>good</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>3.1</td>
      <td>c</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>4.1</td>
      <td>d</td>
      <td>better</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</section>
<section id="indexing-selection-and-filtering" class="level3" data-number="4.1.4">
<h3 data-number="4.1.4" class="anchored" data-anchor-id="indexing-selection-and-filtering"><span class="header-section-number">4.1.4</span> Indexing, Selection, and Filtering</h3>
<ul>
<li><p>Series indexing <code>(obj[...])</code> works analogously to NumPy array indexing, except you can use the Series’s index values instead of only integers.</p></li>
<li><p>We can use logical expresssion to filter DataFrame.</p></li>
</ul>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a>data <span class="op">=</span> pd.DataFrame(np.arange(<span class="dv">16</span>).reshape((<span class="dv">4</span>, <span class="dv">4</span>)),</span>
<span id="cb11-4"><a href="#cb11-4"></a>                    index<span class="op">=</span>[<span class="st">'Ohio'</span>, <span class="st">'Colorado'</span>, <span class="st">'Utah'</span>, <span class="st">'New York'</span>],</span>
<span id="cb11-5"><a href="#cb11-5"></a>                    columns<span class="op">=</span>[<span class="st">'one'</span>, <span class="st">'two'</span>, <span class="st">'three'</span>, <span class="st">'four'</span>])</span>
<span id="cb11-6"><a href="#cb11-6"></a>data[data[<span class="st">'one'</span>]<span class="op">&gt;</span><span class="dv">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
      <th>four</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Utah</th>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<ul>
<li><code>.loc</code>, <code>.iloc</code></li>
</ul>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb12-2"><a href="#cb12-2"></a>data <span class="op">=</span> pd.DataFrame(np.arange(<span class="dv">16</span>).reshape((<span class="dv">4</span>, <span class="dv">4</span>)),</span>
<span id="cb12-3"><a href="#cb12-3"></a>                    index<span class="op">=</span>[<span class="st">'Ohio'</span>, <span class="st">'Colorado'</span>, <span class="st">'Utah'</span>, <span class="st">'New York'</span>],</span>
<span id="cb12-4"><a href="#cb12-4"></a>                    columns<span class="op">=</span>[<span class="st">'one'</span>, <span class="st">'two'</span>, <span class="st">'three'</span>, <span class="st">'four'</span>])</span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="bu">print</span>(data.loc[<span class="st">'Colorado'</span>, [<span class="st">'two'</span>, <span class="st">'three'</span>]])</span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="bu">print</span>(data.iloc[<span class="dv">2</span>, [<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>two      5
three    6
Name: Colorado, dtype: int32
four    11
one      8
two      9
Name: Utah, dtype: int32</code></pre>
</div>
</div>
<ul>
<li>Slicing with labels behaves differently than normal Python slicing in that the endpoint is inclusive.</li>
</ul>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a>obj <span class="op">=</span> pd.Series(np.arange(<span class="fl">4.</span>), index<span class="op">=</span>[<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>])</span>
<span id="cb14-4"><a href="#cb14-4"></a>obj[<span class="st">'b'</span>:<span class="st">'c'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>b    1.0
c    2.0
dtype: float64</code></pre>
</div>
</div>
<ul>
<li>Reindex <code>.reindex()</code>:</li>
</ul>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb16-2"><a href="#cb16-2"></a>data <span class="op">=</span> pd.DataFrame(np.arange(<span class="dv">16</span>).reshape((<span class="dv">4</span>, <span class="dv">4</span>)),</span>
<span id="cb16-3"><a href="#cb16-3"></a>                    index<span class="op">=</span>[<span class="st">'Ohio'</span>, <span class="st">'Colorado'</span>, <span class="st">'Utah'</span>, <span class="st">'New York'</span>],</span>
<span id="cb16-4"><a href="#cb16-4"></a>                    columns<span class="op">=</span>[<span class="st">'one'</span>, <span class="st">'two'</span>, <span class="st">'three'</span>, <span class="st">'four'</span>])</span>
<span id="cb16-5"><a href="#cb16-5"></a></span>
<span id="cb16-6"><a href="#cb16-6"></a>data.reindex(index <span class="op">=</span> [<span class="st">'Colorado'</span>, <span class="st">'Arkansas'</span>, <span class="st">'New York'</span>],</span>
<span id="cb16-7"><a href="#cb16-7"></a>             columns <span class="op">=</span> [<span class="st">'three'</span>, <span class="st">'five'</span>, <span class="st">'one'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>three</th>
      <th>five</th>
      <th>one</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Colorado</th>
      <td>6.0</td>
      <td>NaN</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>Arkansas</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>14.0</td>
      <td>NaN</td>
      <td>12.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>.loc</code> and <code>.reindex</code> are very similar to each other. The main difference between theses two is that <code>.loc</code> will return a view and <code>.reindex</code> will return a copy in most cases.</p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>When locate data using indexes, duplicate labels will return all results.</p>
</div>
</div>
</section>
<section id="essential-functions" class="level3" data-number="4.1.5">
<h3 data-number="4.1.5" class="anchored" data-anchor-id="essential-functions"><span class="header-section-number">4.1.5</span> Essential functions</h3>
<ul>
<li>Arithmetic and Data Alignment Elements of the same index and columns will be computed. By default, if any entry is <code>nan</code>, the answer will be <code>nan</code>. You may use <code>fill_value</code> argument to fill the empty slots.</li>
</ul>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.2 </strong></span>&nbsp;</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-3"><a href="#cb17-3"></a>df1 <span class="op">=</span> pd.DataFrame(np.arange(<span class="fl">12.</span>).reshape((<span class="dv">3</span>, <span class="dv">4</span>)), columns<span class="op">=</span><span class="bu">list</span>(<span class="st">'abcd'</span>))</span>
<span id="cb17-4"><a href="#cb17-4"></a>df2 <span class="op">=</span> pd.DataFrame(np.arange(<span class="fl">20.</span>).reshape((<span class="dv">4</span>, <span class="dv">5</span>)), columns<span class="op">=</span><span class="bu">list</span>(<span class="st">'abcde'</span>))</span>
<span id="cb17-5"><a href="#cb17-5"></a>df2.loc[<span class="dv">1</span>, <span class="st">'b'</span>] <span class="op">=</span> np.nan</span>
<span id="cb17-6"><a href="#cb17-6"></a></span>
<span id="cb17-7"><a href="#cb17-7"></a>df1.add(df2, fill_value<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
      <th>d</th>
      <th>e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>9.0</td>
      <td>5.0</td>
      <td>13.0</td>
      <td>15.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18.0</td>
      <td>20.0</td>
      <td>22.0</td>
      <td>24.0</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15.0</td>
      <td>16.0</td>
      <td>17.0</td>
      <td>18.0</td>
      <td>19.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
<p>Relatedly, when reindexing a Series or DataFrame, you can also specify a <code>fill_value</code>.</p>
</section>
<section id="function-application-and-mapping" class="level3" data-number="4.1.6">
<h3 data-number="4.1.6" class="anchored" data-anchor-id="function-application-and-mapping"><span class="header-section-number">4.1.6</span> Function Application and Mapping</h3>
<p>We may apply functions to each row/column of a DataFrame. If the function is built-in function that is compatible with DataFrame, you can directly call the function that it will be applied automatically to each row/column. If it is not, we can call <code>apply</code> to get the desired result.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.3 </strong></span>&nbsp;</p>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb18-2"><a href="#cb18-2"></a>data <span class="op">=</span> pd.DataFrame(np.random.rand(<span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb18-3"><a href="#cb18-3"></a>                    index<span class="op">=</span>[<span class="st">'Ohio'</span>, <span class="st">'Colorado'</span>, <span class="st">'Utah'</span>, <span class="st">'New York'</span>],</span>
<span id="cb18-4"><a href="#cb18-4"></a>                    columns<span class="op">=</span>[<span class="st">'one'</span>, <span class="st">'two'</span>, <span class="st">'three'</span>, <span class="st">'four'</span>])</span>
<span id="cb18-5"><a href="#cb18-5"></a></span>
<span id="cb18-6"><a href="#cb18-6"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: x.<span class="bu">max</span>() <span class="op">-</span> x.<span class="bu">min</span>()</span>
<span id="cb18-7"><a href="#cb18-7"></a></span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="bu">print</span>(data.<span class="bu">apply</span>(f))</span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="bu">print</span>(data.<span class="bu">apply</span>(f, axis<span class="op">=</span><span class="st">'columns'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>one      0.689110
two      0.587296
three    0.659638
four     0.791388
dtype: float64
Ohio        0.390302
Colorado    0.842843
Utah        0.442810
New York    0.636956
dtype: float64</code></pre>
</div>
</div>
</div>
<p>We can use more complicated function to get more complicated result.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.4 </strong></span>&nbsp;</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb20-2"><a href="#cb20-2"></a>data <span class="op">=</span> pd.DataFrame(np.random.rand(<span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb20-3"><a href="#cb20-3"></a>                    index<span class="op">=</span>[<span class="st">'Ohio'</span>, <span class="st">'Colorado'</span>, <span class="st">'Utah'</span>, <span class="st">'New York'</span>],</span>
<span id="cb20-4"><a href="#cb20-4"></a>                    columns<span class="op">=</span>[<span class="st">'one'</span>, <span class="st">'two'</span>, <span class="st">'three'</span>, <span class="st">'four'</span>])</span>
<span id="cb20-5"><a href="#cb20-5"></a></span>
<span id="cb20-6"><a href="#cb20-6"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: pd.Series([x.<span class="bu">max</span>(), x.<span class="bu">min</span>()], index<span class="op">=</span>[<span class="st">'max'</span>, <span class="st">'min'</span>])</span>
<span id="cb20-7"><a href="#cb20-7"></a></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="bu">print</span>(data.<span class="bu">apply</span>(f))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          one       two     three      four
max  0.504925  0.707601  0.820622  0.963286
min  0.029214  0.274059  0.204042  0.181384</code></pre>
</div>
</div>
</div>
</section>
<section id="sorting-and-ranking" class="level3" data-number="4.1.7">
<h3 data-number="4.1.7" class="anchored" data-anchor-id="sorting-and-ranking"><span class="header-section-number">4.1.7</span> Sorting and Ranking</h3>
<ul>
<li><code>.sort_values(by=)</code></li>
<li><code>.rank(ascending=, method=)</code></li>
</ul>
</section>
<section id="summarizing-and-computing-descriptive-statistics" class="level3" data-number="4.1.8">
<h3 data-number="4.1.8" class="anchored" data-anchor-id="summarizing-and-computing-descriptive-statistics"><span class="header-section-number">4.1.8</span> Summarizing and Computing Descriptive Statistics</h3>
<ul>
<li><code>sum</code>, <code>cumsum</code></li>
<li><code>mean</code>, <code>median</code></li>
<li><code>.describe()</code></li>
<li><code>.cov</code>, <code>.corr</code></li>
</ul>
</section>
<section id="unique-values-value-counts-and-membership" class="level3" data-number="4.1.9">
<h3 data-number="4.1.9" class="anchored" data-anchor-id="unique-values-value-counts-and-membership"><span class="header-section-number">4.1.9</span> Unique Values, Value Counts, and Membership</h3>
<ul>
<li><code>unique</code></li>
<li><code>value_counts</code></li>
</ul>
</section>
<section id="reading-and-writing-data-in-text-format" class="level3" data-number="4.1.10">
<h3 data-number="4.1.10" class="anchored" data-anchor-id="reading-and-writing-data-in-text-format"><span class="header-section-number">4.1.10</span> Reading and Writing Data in Text Format</h3>
<ul>
<li><code>read_csv</code></li>
<li><code>read_excel</code></li>
<li><code>df.to_csv</code></li>
</ul>
</section>
<section id="copies-and-views" class="level3" data-number="4.1.11">
<h3 data-number="4.1.11" class="anchored" data-anchor-id="copies-and-views"><span class="header-section-number">4.1.11</span> Copies and views</h3>
<ul>
<li><code>inplace</code></li>
</ul>
</section>
</section>
<section id="data-cleaning" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="data-cleaning"><span class="header-section-number">4.2</span> Data cleaning</h2>
<section id="handling-missing-data" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="handling-missing-data"><span class="header-section-number">4.2.1</span> Handling Missing Data</h3>
<ul>
<li><code>np.nan</code>, <code>pd.NA</code></li>
<li><code>pd.isnull()</code>, <code>np.isnan()</code></li>
<li><code>dropna</code>, <code>fillna</code></li>
</ul>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.5 </strong></span>&nbsp;</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb22-3"><a href="#cb22-3"></a></span>
<span id="cb22-4"><a href="#cb22-4"></a>data <span class="op">=</span> pd.DataFrame([[<span class="fl">1.</span>, <span class="fl">6.5</span>, <span class="fl">3.</span>], [<span class="fl">1.</span>, np.nan, np.nan], </span>
<span id="cb22-5"><a href="#cb22-5"></a>                     [np.nan, np.nan, np.nan], [np.nan, <span class="fl">6.5</span>, <span class="fl">3.</span>]])</span>
<span id="cb22-6"><a href="#cb22-6"></a>cleaned <span class="op">=</span> data.dropna()</span>
<span id="cb22-7"><a href="#cb22-7"></a>cleanedrow <span class="op">=</span> data.dropna(how<span class="op">=</span><span class="st">'all'</span>)</span>
<span id="cb22-8"><a href="#cb22-8"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>6.5</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>6.5</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a>cleaned</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>6.5</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a>cleanedrow</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>6.5</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>6.5</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a>data[<span class="dv">4</span>] <span class="op">=</span> np.nan</span>
<span id="cb25-2"><a href="#cb25-2"></a>cleaned1 <span class="op">=</span> data.dropna(axis<span class="op">=</span><span class="dv">1</span>, how<span class="op">=</span><span class="st">'all'</span>)</span>
<span id="cb25-3"><a href="#cb25-3"></a>cleanedthresh <span class="op">=</span> data.dropna(thresh<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb25-4"><a href="#cb25-4"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>6.5</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>6.5</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>cleaned1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>6.5</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>6.5</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a>cleanedthresh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>6.5</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>6.5</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a>fill0 <span class="op">=</span> data.fillna(<span class="dv">0</span>)</span>
<span id="cb28-2"><a href="#cb28-2"></a>filldict <span class="op">=</span> data.fillna({<span class="dv">1</span>: <span class="fl">0.5</span>, <span class="dv">2</span>: <span class="op">-</span><span class="fl">0.1</span>})</span>
<span id="cb28-3"><a href="#cb28-3"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>6.5</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>6.5</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a>fill0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>6.5</td>
      <td>3.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.0</td>
      <td>6.5</td>
      <td>3.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a>filldict</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>6.5</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.0</td>
      <td>0.5</td>
      <td>-0.1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>0.5</td>
      <td>-0.1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>6.5</td>
      <td>3.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</section>
<section id="data-transformation" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="data-transformation"><span class="header-section-number">4.2.2</span> Data Transformation</h3>
<ul>
<li><code>.duplicated()</code>, <code>drop_duplicates()</code></li>
</ul>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.6 </strong></span>&nbsp;</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb31-3"><a href="#cb31-3"></a></span>
<span id="cb31-4"><a href="#cb31-4"></a>data <span class="op">=</span> pd.DataFrame({<span class="st">'k1'</span>: [<span class="st">'one'</span>, <span class="st">'two'</span>] <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> [<span class="st">'two'</span>], </span>
<span id="cb31-5"><a href="#cb31-5"></a>                     <span class="st">'k2'</span>: [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>]})</span>
<span id="cb31-6"><a href="#cb31-6"></a>data.drop_duplicates([<span class="st">'k1'</span>], keep<span class="op">=</span><span class="st">'last'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>k1</th>
      <th>k2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>one</td>
      <td>3</td>
    </tr>
    <tr>
      <th>6</th>
      <td>two</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
<ul>
<li><code>pd.Series.map()</code>, <code>pd.DataFrame.apply()</code></li>
</ul>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.7 </strong></span>&nbsp;</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb32-3"><a href="#cb32-3"></a></span>
<span id="cb32-4"><a href="#cb32-4"></a>data <span class="op">=</span> pd.DataFrame({<span class="st">'food'</span>: [<span class="st">'bacon'</span>, <span class="st">'pulled pork'</span>, <span class="st">'bacon'</span>,</span>
<span id="cb32-5"><a href="#cb32-5"></a>                     <span class="st">'Pastrami'</span>, <span class="st">'corned beef'</span>, <span class="st">'Bacon'</span>,</span>
<span id="cb32-6"><a href="#cb32-6"></a>                     <span class="st">'pastrami'</span>, <span class="st">'honey ham'</span>, <span class="st">'nova lox'</span>],</span>
<span id="cb32-7"><a href="#cb32-7"></a>                     <span class="st">'ounces'</span>: [<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">12</span>, <span class="dv">6</span>, <span class="fl">7.5</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">6</span>]})</span>
<span id="cb32-8"><a href="#cb32-8"></a></span>
<span id="cb32-9"><a href="#cb32-9"></a>meat_to_animal <span class="op">=</span> {</span>
<span id="cb32-10"><a href="#cb32-10"></a>    <span class="st">'bacon'</span>: <span class="st">'pig'</span>,</span>
<span id="cb32-11"><a href="#cb32-11"></a>    <span class="st">'pulled pork'</span>: <span class="st">'pig'</span>,</span>
<span id="cb32-12"><a href="#cb32-12"></a>    <span class="st">'pastrami'</span>: <span class="st">'cow'</span>,</span>
<span id="cb32-13"><a href="#cb32-13"></a>    <span class="st">'corned beef'</span>: <span class="st">'cow'</span>,</span>
<span id="cb32-14"><a href="#cb32-14"></a>    <span class="st">'honey ham'</span>: <span class="st">'pig'</span>,</span>
<span id="cb32-15"><a href="#cb32-15"></a>    <span class="st">'nova lox'</span>: <span class="st">'salmon'</span></span>
<span id="cb32-16"><a href="#cb32-16"></a>    }</span>
<span id="cb32-17"><a href="#cb32-17"></a></span>
<span id="cb32-18"><a href="#cb32-18"></a>data[<span class="st">'animal'</span>] <span class="op">=</span> data[<span class="st">'food'</span>].<span class="bu">str</span>.lower().<span class="bu">map</span>(meat_to_animal)</span>
<span id="cb32-19"><a href="#cb32-19"></a></span>
<span id="cb32-20"><a href="#cb32-20"></a>data[<span class="st">'food'</span>].<span class="bu">map</span>(<span class="kw">lambda</span> x: meat_to_animal[x.lower()])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>0       pig
1       pig
2       pig
3       cow
4       cow
5       pig
6       cow
7       pig
8    salmon
Name: food, dtype: object</code></pre>
</div>
</div>
</div>
<ul>
<li><code>replace</code></li>
<li><code>rename</code> <!-- - `pd.cut(ages, bins)` --></li>
<li><code>describe</code></li>
<li><code>permutation</code></li>
<li><code>sample</code></li>
<li>dummy variables</li>
</ul>
</section>
<section id="example-movies" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="example-movies"><span class="header-section-number">4.2.3</span> Example: Movies</h3>
<p>Below we explore the MovieLens 1M datasets. You may download it from this <a href="assests/datasets/movies.dat">link</a>.</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb34-3"><a href="#cb34-3"></a>mnames <span class="op">=</span> [<span class="st">'movie_id'</span>, <span class="st">'title'</span>, <span class="st">'genres'</span>]</span>
<span id="cb34-4"><a href="#cb34-4"></a>movies <span class="op">=</span> pd.read_table(<span class="st">'assests/datasets/movies.dat'</span>, sep<span class="op">=</span><span class="st">'::'</span>,</span>
<span id="cb34-5"><a href="#cb34-5"></a>                       header<span class="op">=</span><span class="va">None</span>, names<span class="op">=</span>mnames, engine<span class="op">=</span><span class="st">"python"</span>,</span>
<span id="cb34-6"><a href="#cb34-6"></a>                       encoding<span class="op">=</span><span class="st">'ISO-8859-1'</span>)</span>
<span id="cb34-7"><a href="#cb34-7"></a></span>
<span id="cb34-8"><a href="#cb34-8"></a>all_genres <span class="op">=</span> <span class="bu">list</span>()</span>
<span id="cb34-9"><a href="#cb34-9"></a>movies[<span class="st">'genres'</span>].<span class="bu">map</span>(<span class="kw">lambda</span> x: all_genres.extend(x.split(<span class="st">'|'</span>)))</span>
<span id="cb34-10"><a href="#cb34-10"></a></span>
<span id="cb34-11"><a href="#cb34-11"></a>genres <span class="op">=</span> pd.unique(all_genres)</span>
<span id="cb34-12"><a href="#cb34-12"></a></span>
<span id="cb34-13"><a href="#cb34-13"></a>dummies <span class="op">=</span> pd.DataFrame(np.zeros((<span class="bu">len</span>(movies), <span class="bu">len</span>(genres))), columns<span class="op">=</span>genres)</span>
<span id="cb34-14"><a href="#cb34-14"></a></span>
<span id="cb34-15"><a href="#cb34-15"></a><span class="cf">for</span> i, gen <span class="kw">in</span> <span class="bu">enumerate</span>(movies.genres):</span>
<span id="cb34-16"><a href="#cb34-16"></a>    indices <span class="op">=</span> dummies.columns.get_indexer(gen.split(<span class="st">'|'</span>))</span>
<span id="cb34-17"><a href="#cb34-17"></a>    dummies.iloc[i, indices] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb34-18"><a href="#cb34-18"></a></span>
<span id="cb34-19"><a href="#cb34-19"></a>movies_windic <span class="op">=</span> movies.join(dummies.add_prefix(<span class="st">'Genre_'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="string-manipulation" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="string-manipulation"><span class="header-section-number">4.2.4</span> String Manipulation</h3>
<p>The key idea in this section is that, all methods in <code>pd.Series.str</code> will be applied to each entry of the Series.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.8 </strong></span>&nbsp;</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb35-3"><a href="#cb35-3"></a>s <span class="op">=</span> pd.Series([<span class="st">"A "</span>, <span class="st">" B "</span>, <span class="st">"C"</span>, <span class="st">"Aaba"</span>, <span class="st">" Baca "</span>, np.nan, <span class="st">"CABA"</span>, <span class="st">"dog"</span>, <span class="st">"cat"</span>])</span>
<span id="cb35-4"><a href="#cb35-4"></a></span>
<span id="cb35-5"><a href="#cb35-5"></a>s.<span class="bu">str</span>.lower()</span>
<span id="cb35-6"><a href="#cb35-6"></a>s.<span class="bu">str</span>.split(<span class="st">'a'</span>)</span>
<span id="cb35-7"><a href="#cb35-7"></a>s.<span class="bu">str</span>.<span class="bu">len</span>()</span>
<span id="cb35-8"><a href="#cb35-8"></a>s.<span class="bu">str</span>.strip()</span>
<span id="cb35-9"><a href="#cb35-9"></a>s.<span class="bu">str</span>.replace(<span class="st">"A"</span>, <span class="st">'1'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>0        1 
1        B 
2         C
3      1aba
4     Baca 
5       NaN
6      C1B1
7       dog
8       cat
dtype: object</code></pre>
</div>
</div>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.9 </strong></span>We could also use <code>.str</code> to play with column names and row indexes.</p>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb37-3"><a href="#cb37-3"></a>df <span class="op">=</span> pd.DataFrame(np.random.randn(<span class="dv">3</span>, <span class="dv">2</span>),</span>
<span id="cb37-4"><a href="#cb37-4"></a>                  columns<span class="op">=</span>[<span class="st">" Column A "</span>, <span class="st">" Column B "</span>], index<span class="op">=</span><span class="bu">range</span>(<span class="dv">3</span>))</span>
<span id="cb37-5"><a href="#cb37-5"></a></span>
<span id="cb37-6"><a href="#cb37-6"></a>df.columns <span class="op">=</span> df.columns.<span class="bu">str</span>.strip().<span class="bu">str</span>.lower().<span class="bu">str</span>.replace(<span class="st">' '</span>, <span class="st">'_'</span>)</span>
<span id="cb37-7"><a href="#cb37-7"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>column_a</th>
      <th>column_b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.674884</td>
      <td>0.130221</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.909302</td>
      <td>-0.468835</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.014714</td>
      <td>1.038037</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</section>
<section id="regular-expression" class="level3" data-number="4.2.5">
<h3 data-number="4.2.5" class="anchored" data-anchor-id="regular-expression"><span class="header-section-number">4.2.5</span> Regular expression</h3>
<p><em>Regular expressions</em> provide a flexible way to search or match string patterns in text. A single expression, commonly called a <em>regex</em>, is a string formed according to the regular expression language. Python’s built-in <code>re</code> module is responsible for applying regular expressions to strings.</p>
<p>For details of the regular expression language in Python, please read the official documents from <a href="https://docs.python.org/3/library/re.html">here</a>. There are also many great websites for learning regex. <a href="https://regex101.com/">This</a> is one example.</p>
<p>We will briefly mentioned a few rules here.</p>
<ul>
<li><code>.</code>: matches any character except a newline.</li>
<li><code>\d</code>: matches any digit. It is the same as <code>[0-9]</code>.</li>
<li><code>\w</code>: matches any alphabatic or numeric character. It is the same as <code>[a-zA-Z0-9_]</code>.</li>
<li><code>\s</code>: matches any whitespaces. It is the same as <code>[\t\n\r\f\v]</code>.</li>
<li><code>*</code>: Causes the resulting RE to match 0 or more repetitions of the preceding RE, as many repetitions as are possible.</li>
<li><code>+</code>: Causes the resulting RE to match 1 or more repetitions of the preceding RE, as many repetitions as are possible.</li>
<li><code>?</code>: Causes the resulting RE to match 0 or 1 repetitions of the preceding RE.</li>
<li><code>*?</code>, <code>+?</code>, <code>??</code>: The <code>*</code>, <code>+</code>, and <code>?</code> qualifiers are all greedy; they match as much text as possible. Adding <code>?</code> after the qualifier makes it perform the match in non-greedy or minimal fashion; as few characters as possible will be matched.</li>
<li><code>{m}</code>: Specifies that exactly m copies of the previous RE should be matched.</li>
<li><code>{m,n}</code>: Causes the resulting RE to match from <code>m</code> to <code>n</code> repetitions of the preceding RE, attempting to match as many repetitions as possible.</li>
<li><code>{m,n}?</code>: Causes the resulting RE to match from <code>m</code> to <code>n</code> repetitions of the preceding RE, attempting to match as few repetitions as possible.</li>
<li><code>[]</code>: Used to indicate a set of characters.</li>
<li><code>()</code>: set groups.</li>
</ul>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.10 </strong></span>&nbsp;</p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a><span class="im">import</span> re</span>
<span id="cb38-2"><a href="#cb38-2"></a>text <span class="op">=</span> <span class="st">"foo bar</span><span class="ch">\t</span><span class="st"> baz </span><span class="ch">\t</span><span class="st">qux"</span></span>
<span id="cb38-3"><a href="#cb38-3"></a>pattern <span class="op">=</span> <span class="st">'\s+'</span></span>
<span id="cb38-4"><a href="#cb38-4"></a>regex <span class="op">=</span> re.<span class="bu">compile</span>(pattern)</span>
<span id="cb38-5"><a href="#cb38-5"></a>regex.split(text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>['foo', 'bar', 'baz', 'qux']</code></pre>
</div>
</div>
</div>
<ul>
<li><code>.match()</code></li>
<li><code>.search()</code></li>
<li><code>.findall()</code></li>
<li><code>.split()</code></li>
<li><code>.sub()</code></li>
</ul>
<p>We can use <code>()</code> to specify groups, and use <code>.groups()</code> to get access to the results.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.11 </strong></span>&nbsp;</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1"></a><span class="im">import</span> re</span>
<span id="cb40-2"><a href="#cb40-2"></a>pattern <span class="op">=</span> <span class="vs">r'([A-Z0-9._%+-]+)@([A-Z0-9.-]+)\.([A-Z]{2,4})'</span></span>
<span id="cb40-3"><a href="#cb40-3"></a>regex <span class="op">=</span> re.<span class="bu">compile</span>(pattern, flags<span class="op">=</span>re.IGNORECASE)</span>
<span id="cb40-4"><a href="#cb40-4"></a>m <span class="op">=</span> regex.match(<span class="st">'wesm@bright.net'</span>)</span>
<span id="cb40-5"><a href="#cb40-5"></a>m.groups()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>('wesm', 'bright', 'net')</code></pre>
</div>
</div>
</div>
<p>To use regex to DataFrame and Series, you may directly apply <code>.match</code>, <code>.findall</code>, <code>.replace</code> after <code>.str</code>, with the regex pattern as one of the arguments.</p>
<p><code>.extract</code> is a method that is not from <code>re</code>. It is used to extract the matched groups and make them as a DataFrame.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.12 </strong></span>&nbsp;</p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb42-3"><a href="#cb42-3"></a>mnames <span class="op">=</span> [<span class="st">'movie_id'</span>, <span class="st">'title'</span>, <span class="st">'genres'</span>]</span>
<span id="cb42-4"><a href="#cb42-4"></a>movies <span class="op">=</span> pd.read_table(<span class="st">'assests/datasets/movies.dat'</span>, sep<span class="op">=</span><span class="st">'::'</span>,</span>
<span id="cb42-5"><a href="#cb42-5"></a>                       header<span class="op">=</span><span class="va">None</span>, names<span class="op">=</span>mnames, engine<span class="op">=</span><span class="st">"python"</span>,</span>
<span id="cb42-6"><a href="#cb42-6"></a>                       encoding<span class="op">=</span><span class="st">'ISO-8859-1'</span>)</span>
<span id="cb42-7"><a href="#cb42-7"></a></span>
<span id="cb42-8"><a href="#cb42-8"></a>pattern <span class="op">=</span> <span class="vs">r'([a-zA-Z0-9_\s,.?:;\']+)\((\d</span><span class="sc">{4}</span><span class="vs">)\)'</span></span>
<span id="cb42-9"><a href="#cb42-9"></a>movies <span class="op">=</span> movies.join(movies.title.<span class="bu">str</span>.extract(pattern).rename(columns<span class="op">=</span>{<span class="dv">0</span>: <span class="st">'movie title'</span>, <span class="dv">1</span>: <span class="st">'year'</span>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
</section>
<section id="data-wrangling" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="data-wrangling"><span class="header-section-number">4.3</span> Data Wrangling</h2>
<section id="hierarchical-indexing" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="hierarchical-indexing"><span class="header-section-number">4.3.1</span> Hierarchical indexing</h3>
<p>Pandas support a more complex indexing system, that the index may have multiple levels. See the following example.</p>
<div class="{$exm-}">
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb43-2"><a href="#cb43-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb43-3"><a href="#cb43-3"></a></span>
<span id="cb43-4"><a href="#cb43-4"></a>data <span class="op">=</span> pd.Series(np.random.randn(<span class="dv">9</span>),</span>
<span id="cb43-5"><a href="#cb43-5"></a>                 index <span class="op">=</span> [[<span class="st">'a'</span>, <span class="st">'a'</span>, <span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'b'</span>, <span class="st">'c'</span>, <span class="st">'c'</span>, <span class="st">'d'</span>, <span class="st">'d'</span>],</span>
<span id="cb43-6"><a href="#cb43-6"></a>                          [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]])</span>
<span id="cb43-7"><a href="#cb43-7"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>a  1   -0.171098
   2    0.519523
   3    0.331171
b  1   -0.198479
   2    1.756868
c  3   -0.240089
   1   -0.326511
d  2    2.031828
   3   -0.175776
dtype: float64</code></pre>
</div>
</div>
<p>You may look at the Series using different levels of indexes.</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a>data[<span class="st">'a'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>1   -0.171098
2    0.519523
3    0.331171
dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1"></a>data.loc[:, <span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>a    0.519523
b    1.756868
d    2.031828
dtype: float64</code></pre>
</div>
</div>
<p>You may use groupby to group by levels and do calculations related to levels. More <code>.groupby()</code> will be discussed in the next section.</p>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a>data.groupby(level<span class="op">=</span><span class="dv">1</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>1   -0.696089
2    4.308219
3   -0.084693
dtype: float64</code></pre>
</div>
</div>
</div>
<p>From the example above, you may notice that the 2-level hierarchical indexing for a Series works very similar to a DataFrame. In fact, you may translate it back and forth between a 2-level indexing Series and a DataFrame.</p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a>df <span class="op">=</span> data.unstack()</span>
<span id="cb51-2"><a href="#cb51-2"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>-0.171098</td>
      <td>0.519523</td>
      <td>0.331171</td>
    </tr>
    <tr>
      <th>b</th>
      <td>-0.198479</td>
      <td>1.756868</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>c</th>
      <td>-0.326511</td>
      <td>NaN</td>
      <td>-0.240089</td>
    </tr>
    <tr>
      <th>d</th>
      <td>NaN</td>
      <td>2.031828</td>
      <td>-0.175776</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1"></a>df.stack()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>a  1   -0.171098
   2    0.519523
   3    0.331171
b  1   -0.198479
   2    1.756868
c  1   -0.326511
   3   -0.240089
d  2    2.031828
   3   -0.175776
dtype: float64</code></pre>
</div>
</div>
<p>For DataFrame the index for both axes can be multiindex. The usual indexing way can be used if you want to start from the first level of the index. The more specific method to extract data is <code>.xs</code>.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.13 </strong></span>&nbsp;</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb54-2"><a href="#cb54-2"></a></span>
<span id="cb54-3"><a href="#cb54-3"></a>df1 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb54-4"><a href="#cb54-4"></a>    {</span>
<span id="cb54-5"><a href="#cb54-5"></a>        <span class="st">"A"</span>: [<span class="st">"A0"</span>, <span class="st">"A1"</span>, <span class="st">"A2"</span>, <span class="st">"A3"</span>],</span>
<span id="cb54-6"><a href="#cb54-6"></a>        <span class="st">"B"</span>: [<span class="st">"B0"</span>, <span class="st">"B1"</span>, <span class="st">"B2"</span>, <span class="st">"B3"</span>],</span>
<span id="cb54-7"><a href="#cb54-7"></a>        <span class="st">"C"</span>: [<span class="st">"C0"</span>, <span class="st">"C1"</span>, <span class="st">"C2"</span>, <span class="st">"C3"</span>],</span>
<span id="cb54-8"><a href="#cb54-8"></a>        <span class="st">"D"</span>: [<span class="st">"D0"</span>, <span class="st">"D1"</span>, <span class="st">"D2"</span>, <span class="st">"D3"</span>],</span>
<span id="cb54-9"><a href="#cb54-9"></a>    },</span>
<span id="cb54-10"><a href="#cb54-10"></a>    index<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb54-11"><a href="#cb54-11"></a>)</span>
<span id="cb54-12"><a href="#cb54-12"></a></span>
<span id="cb54-13"><a href="#cb54-13"></a>df2 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb54-14"><a href="#cb54-14"></a>    {</span>
<span id="cb54-15"><a href="#cb54-15"></a>        <span class="st">"A"</span>: [<span class="st">"A4"</span>, <span class="st">"A5"</span>, <span class="st">"A6"</span>, <span class="st">"A7"</span>],</span>
<span id="cb54-16"><a href="#cb54-16"></a>        <span class="st">"B"</span>: [<span class="st">"B4"</span>, <span class="st">"B5"</span>, <span class="st">"B6"</span>, <span class="st">"B7"</span>],</span>
<span id="cb54-17"><a href="#cb54-17"></a>        <span class="st">"C"</span>: [<span class="st">"C4"</span>, <span class="st">"C5"</span>, <span class="st">"C6"</span>, <span class="st">"C7"</span>],</span>
<span id="cb54-18"><a href="#cb54-18"></a>        <span class="st">"D"</span>: [<span class="st">"D4"</span>, <span class="st">"D5"</span>, <span class="st">"D6"</span>, <span class="st">"D7"</span>],</span>
<span id="cb54-19"><a href="#cb54-19"></a>    },</span>
<span id="cb54-20"><a href="#cb54-20"></a>    index<span class="op">=</span>[<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>],</span>
<span id="cb54-21"><a href="#cb54-21"></a>)</span>
<span id="cb54-22"><a href="#cb54-22"></a></span>
<span id="cb54-23"><a href="#cb54-23"></a>df <span class="op">=</span> pd.concat([df1, df2], keys<span class="op">=</span>[<span class="st">'x'</span>, <span class="st">'y'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">x</th>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">y</th>
      <th>4</th>
      <td>A4</td>
      <td>B4</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>A5</td>
      <td>B5</td>
      <td>C5</td>
      <td>D5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>A6</td>
      <td>B6</td>
      <td>C6</td>
      <td>D6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>A7</td>
      <td>B7</td>
      <td>C7</td>
      <td>D7</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1"></a>df[<span class="st">'A'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>x  0    A0
   1    A1
   2    A2
   3    A3
y  4    A4
   5    A5
   6    A6
   7    A7
Name: A, dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1"></a>df.loc[<span class="st">'x'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1"></a>df.loc[<span class="st">'x'</span>,<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>A    A3
B    B3
C    C3
D    D3
Name: (x, 3), dtype: object</code></pre>
</div>
</div>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1"></a>df.xs(<span class="dv">3</span>, level<span class="op">=</span><span class="dv">1</span>, drop_level<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>x</th>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</section>
<section id="combining-and-merging-datasets" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="combining-and-merging-datasets"><span class="header-section-number">4.3.2</span> Combining and Merging Datasets</h3>
<section id="merge" class="level4" data-number="4.3.2.1">
<h4 data-number="4.3.2.1" class="anchored" data-anchor-id="merge"><span class="header-section-number">4.3.2.1</span> <code>merge()</code></h4>
<p>Merge combines datasets by linking rows using one or more keys. This is from relational databases (e.g., SQL-based).</p>
<p>Here are some examples.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.14 </strong></span>&nbsp;</p>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb62-2"><a href="#cb62-2"></a>df1 <span class="op">=</span> pd.DataFrame({<span class="st">'key'</span>: [<span class="st">'b'</span>, <span class="st">'b'</span>, <span class="st">'a'</span>, <span class="st">'c'</span>, <span class="st">'a'</span>, <span class="st">'a'</span>, <span class="st">'b'</span>],</span>
<span id="cb62-3"><a href="#cb62-3"></a>                    <span class="st">'data1'</span>: <span class="bu">range</span>(<span class="dv">7</span>)})</span>
<span id="cb62-4"><a href="#cb62-4"></a>df2 <span class="op">=</span> pd.DataFrame({<span class="st">'key'</span>: [<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'d'</span>], <span class="st">'data2'</span>: <span class="bu">range</span>(<span class="dv">3</span>)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The two DataFrames are displayed as follows.</p>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1"></a>df1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>key</th>
      <th>data1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>b</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>c</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>a</td>
      <td>5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>b</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>key</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>d</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1"></a>pd.merge(df1, df2, on<span class="op">=</span><span class="st">'key'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>b</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>b</td>
      <td>6</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a</td>
      <td>2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a</td>
      <td>4</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>a</td>
      <td>5</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>If the column names are different in each object, you can specify them separately.</p>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1"></a>df3 <span class="op">=</span> pd.DataFrame({<span class="st">'lkey'</span>: [<span class="st">'b'</span>, <span class="st">'b'</span>, <span class="st">'a'</span>, <span class="st">'c'</span>, <span class="st">'a'</span>, <span class="st">'a'</span>, <span class="st">'b'</span>],</span>
<span id="cb66-2"><a href="#cb66-2"></a>                    <span class="st">'data1'</span>: <span class="bu">range</span>(<span class="dv">7</span>)})</span>
<span id="cb66-3"><a href="#cb66-3"></a>df4 <span class="op">=</span> pd.DataFrame({<span class="st">'rkey'</span>: [<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'d'</span>],</span>
<span id="cb66-4"><a href="#cb66-4"></a>                    <span class="st">'data2'</span>: <span class="bu">range</span>(<span class="dv">3</span>)})</span>
<span id="cb66-5"><a href="#cb66-5"></a>pd.merge(df3, df4, left_on<span class="op">=</span><span class="st">'lkey'</span>, right_on<span class="op">=</span><span class="st">'rkey'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>lkey</th>
      <th>data1</th>
      <th>rkey</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>b</td>
      <td>0</td>
      <td>b</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>1</td>
      <td>b</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>b</td>
      <td>6</td>
      <td>b</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a</td>
      <td>2</td>
      <td>a</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a</td>
      <td>4</td>
      <td>a</td>
      <td>0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>a</td>
      <td>5</td>
      <td>a</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
<p>By default <code>merge</code> does an inner join, that the keys in the result are the interesection found in both tables. Below are different types of <code>merge</code>. To specify the method for merge, the option is <code>how</code>.</p>
<ul>
<li><code>inner</code></li>
<li><code>left</code></li>
<li><code>right</code></li>
<li><code>outer</code></li>
</ul>
<p>Let’s see the following examples.</p>
<div class="grid">
<div class="g-col-6">
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1"></a>df1 <span class="op">=</span> pd.DataFrame({<span class="st">'Key'</span>: [<span class="dv">1</span>, <span class="dv">2</span>], <span class="st">'A'</span>: [<span class="dv">0</span>, <span class="dv">2</span>], <span class="st">'B'</span>: [<span class="dv">1</span>, <span class="dv">3</span>]})</span>
<span id="cb67-2"><a href="#cb67-2"></a>df1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Key</th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
<div class="g-col-6">
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1"></a>df2 <span class="op">=</span> pd.DataFrame({<span class="st">'Key'</span>: [<span class="dv">1</span>, <span class="dv">3</span>], <span class="st">'C'</span>: [<span class="dv">0</span>, <span class="dv">2</span>], <span class="st">'D'</span>: [<span class="dv">1</span>, <span class="dv">3</span>]})</span>
<span id="cb68-2"><a href="#cb68-2"></a>df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Key</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>2</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="grid">
<div class="g-col-6">
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1"></a>pd.merge(df1, df2, on<span class="op">=</span><span class="st">'Key'</span>, how<span class="op">=</span><span class="st">'inner'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Key</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
<div class="g-col-6">
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1"></a>pd.merge(df1, df2, on<span class="op">=</span><span class="st">'Key'</span>, how<span class="op">=</span><span class="st">'outer'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Key</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="grid">
<div class="g-col-6">
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1"></a>pd.merge(df1, df2, on<span class="op">=</span><span class="st">'Key'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Key</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
<div class="g-col-6">
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1"></a>pd.merge(df1, df2, on<span class="op">=</span><span class="st">'Key'</span>, how<span class="op">=</span><span class="st">'right'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Key</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2</td>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If a key combination appears more than once in both tables, the resulting table will have the Cartesian product of the associated data. Here is a very basic example with one unique key combination.</p>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1"></a>df1 <span class="op">=</span> pd.DataFrame({<span class="st">'key'</span>: [<span class="st">'b'</span>, <span class="st">'b'</span>, <span class="st">'a'</span>, <span class="st">'c'</span>, <span class="st">'a'</span>, <span class="st">'b'</span>],</span>
<span id="cb73-2"><a href="#cb73-2"></a>                    <span class="st">'data1'</span>: <span class="bu">range</span>(<span class="dv">6</span>)})</span>
<span id="cb73-3"><a href="#cb73-3"></a>df2 <span class="op">=</span> pd.DataFrame({<span class="st">'key'</span>: [<span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'d'</span>],</span>
<span id="cb73-4"><a href="#cb73-4"></a>                    <span class="st">'data2'</span>: <span class="bu">range</span>(<span class="dv">5</span>)})</span>
<span id="cb73-5"><a href="#cb73-5"></a>pd.merge(df1, df2, on<span class="op">=</span><span class="st">'key'</span>, how<span class="op">=</span><span class="st">'left'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>b</td>
      <td>0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>b</td>
      <td>0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>b</td>
      <td>1</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>b</td>
      <td>1</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a</td>
      <td>2</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>a</td>
      <td>2</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>c</td>
      <td>3</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>a</td>
      <td>4</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>a</td>
      <td>4</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>b</td>
      <td>5</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>b</td>
      <td>5</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>If the merge keys in a DataFrame is in its index instead of column(s), we could pass <code>left_index=True</code> or <code>right_index=True</code> or both instead of setting <code>left_on</code>/<code>right_on</code>/<code>on</code>.</p>
</div>
</div>
<div id="exm-crossexample-deck" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.15 </strong></span>If we want to really create a Cartesian product, we may use the option <code>how='cross'</code>. For example, we would like to generate a deck of cards, we may use the following codes.</p>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1"></a>suit <span class="op">=</span> pd.DataFrame({<span class="st">'suit'</span>: [<span class="st">'spades'</span>, <span class="st">'hearts'</span>, <span class="st">'clubs'</span>, <span class="st">'diamonds'</span>]})</span>
<span id="cb74-2"><a href="#cb74-2"></a>face <span class="op">=</span> pd.DataFrame({<span class="st">'face'</span>: <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">14</span>))})</span>
<span id="cb74-3"><a href="#cb74-3"></a>deck <span class="op">=</span> pd.merge(suit, face, how<span class="op">=</span><span class="st">'cross'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="concat" class="level4" data-number="4.3.2.2">
<h4 data-number="4.3.2.2" class="anchored" data-anchor-id="concat"><span class="header-section-number">4.3.2.2</span> <code>concat()</code></h4>
<p>The <code>concat()</code> function (in the main pandas namespace) performs concatenation operations along an axis while performing optional set logic (union or intersection) of the indexes (if any) on the other axes.</p>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb75-2"><a href="#cb75-2"></a></span>
<span id="cb75-3"><a href="#cb75-3"></a>df1 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb75-4"><a href="#cb75-4"></a>    {</span>
<span id="cb75-5"><a href="#cb75-5"></a>        <span class="st">"A"</span>: [<span class="st">"A0"</span>, <span class="st">"A1"</span>, <span class="st">"A2"</span>, <span class="st">"A3"</span>],</span>
<span id="cb75-6"><a href="#cb75-6"></a>        <span class="st">"B"</span>: [<span class="st">"B0"</span>, <span class="st">"B1"</span>, <span class="st">"B2"</span>, <span class="st">"B3"</span>],</span>
<span id="cb75-7"><a href="#cb75-7"></a>        <span class="st">"C"</span>: [<span class="st">"C0"</span>, <span class="st">"C1"</span>, <span class="st">"C2"</span>, <span class="st">"C3"</span>],</span>
<span id="cb75-8"><a href="#cb75-8"></a>        <span class="st">"D"</span>: [<span class="st">"D0"</span>, <span class="st">"D1"</span>, <span class="st">"D2"</span>, <span class="st">"D3"</span>],</span>
<span id="cb75-9"><a href="#cb75-9"></a>    },</span>
<span id="cb75-10"><a href="#cb75-10"></a>    index<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb75-11"><a href="#cb75-11"></a>)</span>
<span id="cb75-12"><a href="#cb75-12"></a></span>
<span id="cb75-13"><a href="#cb75-13"></a>df2 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb75-14"><a href="#cb75-14"></a>    {</span>
<span id="cb75-15"><a href="#cb75-15"></a>        <span class="st">"A"</span>: [<span class="st">"A4"</span>, <span class="st">"A5"</span>, <span class="st">"A6"</span>, <span class="st">"A7"</span>],</span>
<span id="cb75-16"><a href="#cb75-16"></a>        <span class="st">"B"</span>: [<span class="st">"B4"</span>, <span class="st">"B5"</span>, <span class="st">"B6"</span>, <span class="st">"B7"</span>],</span>
<span id="cb75-17"><a href="#cb75-17"></a>        <span class="st">"C"</span>: [<span class="st">"C4"</span>, <span class="st">"C5"</span>, <span class="st">"C6"</span>, <span class="st">"C7"</span>],</span>
<span id="cb75-18"><a href="#cb75-18"></a>        <span class="st">"D"</span>: [<span class="st">"D4"</span>, <span class="st">"D5"</span>, <span class="st">"D6"</span>, <span class="st">"D7"</span>],</span>
<span id="cb75-19"><a href="#cb75-19"></a>    },</span>
<span id="cb75-20"><a href="#cb75-20"></a>    index<span class="op">=</span>[<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>],</span>
<span id="cb75-21"><a href="#cb75-21"></a>)</span>
<span id="cb75-22"><a href="#cb75-22"></a></span>
<span id="cb75-23"><a href="#cb75-23"></a>df3 <span class="op">=</span> pd.DataFrame(</span>
<span id="cb75-24"><a href="#cb75-24"></a>    {</span>
<span id="cb75-25"><a href="#cb75-25"></a>        <span class="st">"A"</span>: [<span class="st">"A8"</span>, <span class="st">"A9"</span>, <span class="st">"A10"</span>, <span class="st">"A11"</span>],</span>
<span id="cb75-26"><a href="#cb75-26"></a>        <span class="st">"B"</span>: [<span class="st">"B8"</span>, <span class="st">"B9"</span>, <span class="st">"B10"</span>, <span class="st">"B11"</span>],</span>
<span id="cb75-27"><a href="#cb75-27"></a>        <span class="st">"C"</span>: [<span class="st">"C8"</span>, <span class="st">"C9"</span>, <span class="st">"C10"</span>, <span class="st">"C11"</span>],</span>
<span id="cb75-28"><a href="#cb75-28"></a>        <span class="st">"D"</span>: [<span class="st">"D8"</span>, <span class="st">"D9"</span>, <span class="st">"D10"</span>, <span class="st">"D11"</span>],</span>
<span id="cb75-29"><a href="#cb75-29"></a>    },</span>
<span id="cb75-30"><a href="#cb75-30"></a>    index<span class="op">=</span>[<span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>],</span>
<span id="cb75-31"><a href="#cb75-31"></a>)</span>
<span id="cb75-32"><a href="#cb75-32"></a></span>
<span id="cb75-33"><a href="#cb75-33"></a>pd.concat([df1, df2, df3], keys<span class="op">=</span>[<span class="st">'x'</span>, <span class="st">'y'</span>, <span class="st">'z'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="57">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="4" valign="top">x</th>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">y</th>
      <th>4</th>
      <td>A4</td>
      <td>B4</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>A5</td>
      <td>B5</td>
      <td>C5</td>
      <td>D5</td>
    </tr>
    <tr>
      <th>6</th>
      <td>A6</td>
      <td>B6</td>
      <td>C6</td>
      <td>D6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>A7</td>
      <td>B7</td>
      <td>C7</td>
      <td>D7</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">z</th>
      <th>8</th>
      <td>A8</td>
      <td>B8</td>
      <td>C8</td>
      <td>D8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>A9</td>
      <td>B9</td>
      <td>C9</td>
      <td>D9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>A10</td>
      <td>B10</td>
      <td>C10</td>
      <td>D10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>A11</td>
      <td>B11</td>
      <td>C11</td>
      <td>D11</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>The default way of <code>pd.concat()</code> is vertically. Note that it will check the column names. If the column names don’t match, new columns will be created and <code>nan</code> values will be assigned.</p>
<p>If you want to concatenate the DataFrame horizontally you need to add <code>axis=1</code> option. Similarly, row index will be checked before concatenating. See the following example.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.16 </strong></span>&nbsp;</p>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1"></a>pd.concat([df1, df2, df3], axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>D2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>A4</td>
      <td>B4</td>
      <td>C4</td>
      <td>D4</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>A5</td>
      <td>B5</td>
      <td>C5</td>
      <td>D5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>A6</td>
      <td>B6</td>
      <td>C6</td>
      <td>D6</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>A7</td>
      <td>B7</td>
      <td>C7</td>
      <td>D7</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>A8</td>
      <td>B8</td>
      <td>C8</td>
      <td>D8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>A9</td>
      <td>B9</td>
      <td>C9</td>
      <td>D9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>A10</td>
      <td>B10</td>
      <td>C10</td>
      <td>D10</td>
    </tr>
    <tr>
      <th>11</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>A11</td>
      <td>B11</td>
      <td>C11</td>
      <td>D11</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.17 </strong></span>Consider the deck example from <a href="#exm-crossexample-deck">Example&nbsp;<span>4.15</span></a>. This time we would like to use <code>pd.concat()</code> to get the result.</p>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1"></a>suitlist <span class="op">=</span> [<span class="st">'spades'</span>, <span class="st">'hearts'</span>, <span class="st">'clubs'</span>, <span class="st">'diamonds'</span>]</span>
<span id="cb77-2"><a href="#cb77-2"></a>facelist <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">14</span>))</span>
<span id="cb77-3"><a href="#cb77-3"></a>decklist <span class="op">=</span> [pd.DataFrame({<span class="st">'suit'</span>: suit, <span class="st">'face'</span>: facelist}) <span class="cf">for</span> suit <span class="kw">in</span> suitlist]</span>
<span id="cb77-4"><a href="#cb77-4"></a>deck <span class="op">=</span> pd.concat(decklist, ignore_index<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
</section>
</section>
<section id="data-aggregation-and-group-operations" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="data-aggregation-and-group-operations"><span class="header-section-number">4.4</span> Data Aggregation and Group Operations</h2>
<section id="split-apply-combine-model" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="split-apply-combine-model"><span class="header-section-number">4.4.1</span> split-apply-combine model</h3>
<p>We would like to apply group operations based on the split-apply-combine model.</p>
<ul>
<li>In the first stage of the process, data contained in a pandas object is <em>split</em> into groups based on one or more keys that you provide. We then use <code>.groupby(keys)</code> to perform the split step. The result is a grouped <code>groupby</code> object.</li>
<li>Once this is done, a function is <em>applied</em> to each group, producing a new value.</li>
<li>Finally the results of all those function applications are combined into a result object. We may apply groupby functions directly as methods to groupby objects.The result is the combined result object.</li>
</ul>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.18 </strong></span>&nbsp;</p>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb78-2"><a href="#cb78-2"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'key1'</span> : [<span class="st">'a'</span>, <span class="st">'a'</span>, <span class="st">'b'</span>, <span class="st">'b'</span>, <span class="st">'a'</span>],</span>
<span id="cb78-3"><a href="#cb78-3"></a>                   <span class="st">'key2'</span> : [<span class="st">'one'</span>, <span class="st">'two'</span>, <span class="st">'one'</span>, <span class="st">'two'</span>, <span class="st">'one'</span>],</span>
<span id="cb78-4"><a href="#cb78-4"></a>                   <span class="st">'data1'</span> : np.random.randn(<span class="dv">5</span>),</span>
<span id="cb78-5"><a href="#cb78-5"></a>                   <span class="st">'data2'</span> : np.random.randn(<span class="dv">5</span>)})</span>
<span id="cb78-6"><a href="#cb78-6"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>key1</th>
      <th>key2</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>one</td>
      <td>0.665669</td>
      <td>0.297271</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a</td>
      <td>two</td>
      <td>-1.001723</td>
      <td>-0.483345</td>
    </tr>
    <tr>
      <th>2</th>
      <td>b</td>
      <td>one</td>
      <td>1.274018</td>
      <td>-1.057444</td>
    </tr>
    <tr>
      <th>3</th>
      <td>b</td>
      <td>two</td>
      <td>0.715423</td>
      <td>-0.594231</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a</td>
      <td>one</td>
      <td>-1.433001</td>
      <td>1.030055</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Now we want to group <code>data1</code> in <code>df</code> by <code>key1</code>.</p>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1"></a>grouped <span class="op">=</span> df[<span class="st">'data1'</span>].groupby(df[<span class="st">'key1'</span>])</span>
<span id="cb79-2"><a href="#cb79-2"></a>grouped</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>&lt;pandas.core.groupby.generic.SeriesGroupBy object at 0x000001F6979C4940&gt;</code></pre>
</div>
</div>
<p>What we get is a groupby object and we could apply group functions to it.</p>
<p>The method to look at each group is <code>.get_group</code>.</p>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1"></a>grouped.get_group(<span class="st">'a'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>0    0.665669
1   -1.001723
4   -1.433001
Name: data1, dtype: float64</code></pre>
</div>
</div>
<p>We may directly apply some group functions to the groupby object.</p>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1"></a>grouped.mean()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>key1
a   -0.589685
b    0.994720
Name: data1, dtype: float64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1"></a>grouped.size()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>key1
a    3
b    2
Name: data1, dtype: int64</code></pre>
</div>
</div>
<p>We could iterate over groups.</p>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1"></a><span class="cf">for</span> name, group <span class="kw">in</span> grouped:</span>
<span id="cb87-2"><a href="#cb87-2"></a>    <span class="bu">print</span>(<span class="st">'name'</span>, name)</span>
<span id="cb87-3"><a href="#cb87-3"></a>    <span class="bu">print</span>(<span class="st">'group'</span>, group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>name a
group 0    0.665669
1   -1.001723
4   -1.433001
Name: data1, dtype: float64
name b
group 2    1.274018
3    0.715423
Name: data1, dtype: float64</code></pre>
</div>
</div>
<p>We could convert the group object into list and dictionary.</p>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1"></a><span class="bu">list</span>(grouped)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>[('a',
  0    0.665669
  1   -1.001723
  4   -1.433001
  Name: data1, dtype: float64),
 ('b',
  2    1.274018
  3    0.715423
  Name: data1, dtype: float64)]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1"></a><span class="bu">dict</span>(<span class="bu">list</span>(grouped))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>{'a': 0    0.665669
 1   -1.001723
 4   -1.433001
 Name: data1, dtype: float64,
 'b': 2    1.274018
 3    0.715423
 Name: data1, dtype: float64}</code></pre>
</div>
</div>
</div>
</section>
<section id="more-aggregation-functions" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="more-aggregation-functions"><span class="header-section-number">4.4.2</span> More aggregation functions</h3>
<ul>
<li><code>.describe()</code></li>
<li><code>.count()</code></li>
<li><code>.sum()</code></li>
<li><code>.mean()</code></li>
<li><code>.median</code></li>
<li><code>.std()</code>, <code>.var()</code></li>
<li><code>.min()</code>, <code>.max()</code></li>
<li><code>.prod()</code></li>
<li><code>first()</code>, <code>.last()</code></li>
<li><code>.agg()</code></li>
</ul>
</section>
<section id="some-examples" class="level3" data-number="4.4.3">
<h3 data-number="4.4.3" class="anchored" data-anchor-id="some-examples"><span class="header-section-number">4.4.3</span> Some examples</h3>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 4.19 </strong></span>Consider the following DataFrame.</p>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb93-2"><a href="#cb93-2"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'location'</span>: [<span class="st">'East'</span>, <span class="st">'East'</span>, <span class="st">'East'</span>, <span class="st">'East'</span>,</span>
<span id="cb93-3"><a href="#cb93-3"></a>                                <span class="st">'West'</span>, <span class="st">'West'</span>, <span class="st">'West'</span>, <span class="st">'West'</span>],</span>
<span id="cb93-4"><a href="#cb93-4"></a>                   <span class="st">'data'</span>: np.random.randn(<span class="dv">8</span>)},</span>
<span id="cb93-5"><a href="#cb93-5"></a>                   index<span class="op">=</span>[<span class="st">'Ohio'</span>, <span class="st">'New York'</span>, <span class="st">'Vermont'</span>, <span class="st">'Florida'</span>,</span>
<span id="cb93-6"><a href="#cb93-6"></a>                          <span class="st">'Oregon'</span>, <span class="st">'Nevada'</span>, <span class="st">'California'</span>, <span class="st">'Idaho'</span>])</span>
<span id="cb93-7"><a href="#cb93-7"></a>df.loc[[<span class="st">'Vermont'</span>, <span class="st">'Nevada'</span>, <span class="st">'Idaho'</span>], <span class="st">'data'</span>] <span class="op">=</span> np.nan</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We would like to fill in NA values with the mean from each group.</p>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1"></a>df.groupby(<span class="st">'location'</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.fillna(x.mean()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\Xinli\AppData\Local\Temp\ipykernel_22628\2040193686.py:1: FutureWarning:

Dropping of nuisance columns in DataFrame reductions (with 'numeric_only=None') is deprecated; in a future version this will raise TypeError.  Select only valid columns before calling the reduction.
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="69">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>location</th>
      <th>data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>East</td>
      <td>-0.330638</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>East</td>
      <td>0.693907</td>
    </tr>
    <tr>
      <th>Vermont</th>
      <td>East</td>
      <td>-0.116019</td>
    </tr>
    <tr>
      <th>Florida</th>
      <td>East</td>
      <td>-0.711327</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>West</td>
      <td>-0.333179</td>
    </tr>
    <tr>
      <th>Nevada</th>
      <td>West</td>
      <td>-0.256621</td>
    </tr>
    <tr>
      <th>California</th>
      <td>West</td>
      <td>-0.180064</td>
    </tr>
    <tr>
      <th>Idaho</th>
      <td>West</td>
      <td>-0.256621</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>We could also fill in NA values with predefined values, similar to the non-groupby case.</p>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1"></a>df.groupby(<span class="st">'location'</span>).<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.fillna({<span class="st">'East'</span>: <span class="fl">0.1</span>,</span>
<span id="cb96-2"><a href="#cb96-2"></a>                                                 <span class="st">'West'</span>: <span class="op">-</span><span class="fl">0.5</span>}[x.name]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>location</th>
      <th>data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Ohio</th>
      <td>East</td>
      <td>-0.330638</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>East</td>
      <td>0.693907</td>
    </tr>
    <tr>
      <th>Vermont</th>
      <td>East</td>
      <td>0.100000</td>
    </tr>
    <tr>
      <th>Florida</th>
      <td>East</td>
      <td>-0.711327</td>
    </tr>
    <tr>
      <th>Oregon</th>
      <td>West</td>
      <td>-0.333179</td>
    </tr>
    <tr>
      <th>Nevada</th>
      <td>West</td>
      <td>-0.500000</td>
    </tr>
    <tr>
      <th>California</th>
      <td>West</td>
      <td>-0.180064</td>
    </tr>
    <tr>
      <th>Idaho</th>
      <td>West</td>
      <td>-0.500000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="exercises" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="exercises"><span class="header-section-number">4.5</span> Exercises</h2>
<p>Most problems are based on <span class="citation" data-cites="Pra2018a">[<a href="../references.html#ref-Pra2018a" role="doc-biblioref">1</a>]</span>.</p>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.1 </strong></span>Please use the following code to generate a series <code>ser</code>, and then finish the following tasks.</p>
<div class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb97-2"><a href="#cb97-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb97-3"><a href="#cb97-3"></a></span>
<span id="cb97-4"><a href="#cb97-4"></a></span>
<span id="cb97-5"><a href="#cb97-5"></a>mylist <span class="op">=</span> <span class="bu">list</span>(<span class="st">'abcedfghijklmnopqrstuvwxyz'</span>)</span>
<span id="cb97-6"><a href="#cb97-6"></a>myarr <span class="op">=</span> np.arange(<span class="dv">26</span>)</span>
<span id="cb97-7"><a href="#cb97-7"></a>mydict <span class="op">=</span> <span class="bu">dict</span>(<span class="bu">zip</span>(mylist, myarr))</span>
<span id="cb97-8"><a href="#cb97-8"></a>ser <span class="op">=</span> pd.Series(mydict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>Convert the series <code>ser</code> into a dataframe <code>df</code> with its index as another column on the dataframe.</li>
<li>Pick the two columns of <code>df</code> and set them into two serieses <code>ser1</code> and <code>ser2</code>.</li>
<li>Combine two series <code>ser1</code> and <code>ser2</code> to form a new dataframe <code>newdf</code>, and name their columns <code>ser1</code> and <code>ser2</code>.</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.2 </strong></span>Consider two serieses <code>ser1</code> and <code>ser2</code>. You may use the following <code>ser1</code> and <code>ser2</code> as an example. The output of each questions below should be a series. You may want to learn the following commands:</p>
<ul>
<li><a href="https://numpy.org/doc/stable/reference/generated/numpy.union1d.html"><code>np.union1d()</code></a></li>
<li><a href="https://numpy.org/doc/stable/reference/generated/numpy.intersect1d.html"><code>np.intersect1d()</code></a></li>
<li><a href="https://numpy.org/doc/stable/reference/generated/numpy.isin.html"><code>np.isin()</code></a></li>
</ul>
<div class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb98-2"><a href="#cb98-2"></a></span>
<span id="cb98-3"><a href="#cb98-3"></a>ser1 <span class="op">=</span> pd.Series([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb98-4"><a href="#cb98-4"></a>ser2 <span class="op">=</span> pd.Series([<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>Find all the elements from <code>ser1</code> that are also in <code>ser2</code>.</li>
<li>Find all the elements from <code>ser2</code> that are also in <code>ser1</code>.</li>
<li>From <code>ser1</code> remove items present in <code>ser2</code>.</li>
<li>Find the union of <code>ser1</code> and <code>ser2</code>.</li>
<li>Find the intersection of <code>ser1</code> and <code>ser2</code>.</li>
<li>Find all the elemetns that are in either <code>ser1</code> or <code>ser2</code>, but not both.</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.3 (Some statistics) </strong></span>Please check the following commands and answer the following questions.</p>
<ul>
<li><a href="https://numpy.org/doc/stable/reference/generated/numpy.percentile.html"><code>np.percentile()</code></a></li>
</ul>
<p>How to get the minimum, 25th percentile, median, 75th, and max of a numeric series? You may use the following Series as an example.</p>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb99-2"><a href="#cb99-2"></a>ser <span class="op">=</span> pd.Series(np.random.normal(<span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">25</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.4 </strong></span>Please use <code>pd.Series.value_counts()</code> to calculte the frequency counts of each unique value of the following Series.</p>
<div class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb100-2"><a href="#cb100-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb100-3"><a href="#cb100-3"></a>ser <span class="op">=</span> pd.Series(np.take(<span class="bu">list</span>(<span class="st">'abcdefgh'</span>), np.random.randint(<span class="dv">8</span>, size<span class="op">=</span><span class="dv">30</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.5 </strong></span>Please keep the top 2 most frequent items of <code>ser</code> as it is and replace everything else as <code>Other</code>.</p>
<div class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb101-2"><a href="#cb101-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb101-3"><a href="#cb101-3"></a>ser <span class="op">=</span> pd.Series(np.take(<span class="bu">list</span>(<span class="st">'abcdefgh'</span>), np.random.randint(<span class="dv">8</span>, size<span class="op">=</span><span class="dv">30</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.6 </strong></span>Please use <code>pd.cut</code> or <code>pd.qcut</code> to bin the Series <code>ser</code> into 10 equal deciles. You may use the following <code>ser</code> as an example.</p>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb102-2"><a href="#cb102-2"></a>ser <span class="op">=</span> pd.Series(np.random.random(<span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.7 </strong></span>Consider the Series <code>ser</code>:</p>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb103-2"><a href="#cb103-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb103-3"><a href="#cb103-3"></a>ser <span class="op">=</span> pd.Series(np.random.randint(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Find the positions of numbers that are multiples of 3 from ser.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.8 </strong></span>Compute the mean of <code>weights</code> of each <code>fruit</code>.</p>
<div class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb104-2"><a href="#cb104-2"></a>fruit <span class="op">=</span> pd.Series(np.random.choice([<span class="st">'apple'</span>, <span class="st">'banana'</span>, <span class="st">'carrot'</span>], <span class="dv">10</span>))</span>
<span id="cb104-3"><a href="#cb104-3"></a>weights <span class="op">=</span> pd.Series(np.linspace(<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb104-4"><a href="#cb104-4"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'fruit'</span>: fruit, <span class="st">'weights'</span>: weights})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.9 </strong></span>Consider the following DataFrame.</p>
<div class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb105-2"><a href="#cb105-2"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'https://raw.githubusercontent.com/selva86/datasets/master/Cars93_miss.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>Check if <code>df</code> has any missing values.</li>
<li>Please count the number of missing values in each column.</li>
<li>Please replace all missing values in <code>Min.Price</code> and <code>Max.Price</code> with their mean respectively.</li>
</ol>
<!-- 3. In the original DataFrame, please replace the missing values in `Min.Price` with the column's mean and those in `Max.Price` with the column's median. -->
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.10 </strong></span>Replace the spaces in <code>my_str = 'dbc deb abed gade'</code> with the least frequent character.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.11 </strong></span>Suppress scientific notations like <code>e-03</code> in <code>df</code> and print up to 4 numbers after decimal.</p>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb106-2"><a href="#cb106-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb106-3"><a href="#cb106-3"></a>df <span class="op">=</span> pd.DataFrame(np.random.random(<span class="dv">4</span>)<span class="op">**</span><span class="dv">10</span>, columns<span class="op">=</span>[<span class="st">'random'</span>])</span>
<span id="cb106-4"><a href="#cb106-4"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>random</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.076951e-08</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.587507e-04</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.571868e-05</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.370656e-07</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.12 </strong></span>Format the values in column <code>random</code> of <code>df</code> as percentages.</p>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb107-2"><a href="#cb107-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb107-3"><a href="#cb107-3"></a>df <span class="op">=</span> pd.DataFrame(np.random.random(<span class="dv">4</span>), columns<span class="op">=</span>[<span class="st">'random'</span>])</span>
<span id="cb107-4"><a href="#cb107-4"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>random</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.006638</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.947877</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.943286</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.143179</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.13 (Regular expressions) </strong></span>Please use regular expressions to finish the following tasks.</p>
<ol type="1">
<li>Match a string that has an <code>a</code> followed by zero or more <code>b</code>’s.</li>
<li>Match a string that has an <code>a</code> followed by one or more <code>b</code>’s.</li>
<li>Match a string that has an <code>a</code> followed by zero or one <code>b</code>.</li>
<li>Match a string that has an <code>a</code> followed by three <code>b</code>’s.</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.14 (More regex) </strong></span>Find all words starting with <code>a</code> or <code>e</code> in a given string:</p>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1"></a>text <span class="op">=</span> <span class="st">"The following example creates an ArrayList with a capacity of 50 elements. Four elements are then added to the ArrayList and the ArrayList is trimmed accordingly."</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.15 (More regex) </strong></span>Write a Python code to extract year, month and date from a <code>url1</code>:</p>
<div class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1"></a>url1<span class="op">=</span> <span class="st">"https://www.washingtonpost.com/news/football-insider/wp/2016/09/02/odell-beckhams-fame-rests-on-one-stupid-little-ball-josh-norman-tells-author/"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.16 (More regex) </strong></span>Please use regex to parse the following str to create a dictionary.</p>
<div class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1"></a>text <span class="op">=</span> <span class="vs">r'''</span></span>
<span id="cb110-2"><a href="#cb110-2"></a><span class="vs">{</span></span>
<span id="cb110-3"><a href="#cb110-3"></a><span class="vs">    name: Firstname Lastname;</span></span>
<span id="cb110-4"><a href="#cb110-4"></a><span class="vs">    age: 100;</span></span>
<span id="cb110-5"><a href="#cb110-5"></a><span class="vs">    salary: 10000 </span></span>
<span id="cb110-6"><a href="#cb110-6"></a><span class="vs">}</span></span>
<span id="cb110-7"><a href="#cb110-7"></a><span class="vs">'''</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.17 </strong></span>Consider the following DataFrame.</p>
<div class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1"></a>data <span class="op">=</span> [[<span class="st">'Evert van Dijk'</span>, <span class="st">'Carmine-pink, salmon-pink streaks, stripes, flecks.  Warm pink, clear carmine pink, rose pink shaded salmon.  Mild fragrance.  Large, very double, in small clusters, high-centered bloom form.  Blooms in flushes throughout the season.'</span>],</span>
<span id="cb111-2"><a href="#cb111-2"></a>        [<span class="st">'Every Good Gift'</span>, <span class="st">'Red.  Flowers velvety red.  Moderate fragrance.  Average diameter 4".  Medium-large, full (26-40 petals), borne mostly solitary bloom form.  Blooms in flushes throughout the season.'</span>], </span>
<span id="cb111-3"><a href="#cb111-3"></a>        [<span class="st">'Evghenya'</span>, <span class="st">'Orange-pink.  75 petals.  Large, very double bloom form.  Blooms in flushes throughout the season.'</span>], </span>
<span id="cb111-4"><a href="#cb111-4"></a>        [<span class="st">'Evita'</span>, <span class="st">'White or white blend.  None to mild fragrance.  35 petals.  Large, full (26-40 petals), high-centered bloom form.  Blooms in flushes throughout the season.'</span>],</span>
<span id="cb111-5"><a href="#cb111-5"></a>        [<span class="st">'Evrathin'</span>, <span class="st">'Light pink. [Deep pink.]  Outer petals white. Expand rarely.  Mild fragrance.  35 to 40 petals.  Average diameter 2.5".  Medium, double (17-25 petals), full (26-40 petals), cluster-flowered, in small clusters bloom form.  Prolific, once-blooming spring or summer.  Glandular sepals, leafy sepals, long sepals buds.'</span>],</span>
<span id="cb111-6"><a href="#cb111-6"></a>        [<span class="st">'Evita 2'</span>, <span class="st">'White, blush shading.  Mild, wild rose fragrance.  20 to 25 petals.  Average diameter 1.25".  Small, very double, cluster-flowered bloom form.  Blooms in flushes throughout the season.'</span>]]</span>
<span id="cb111-7"><a href="#cb111-7"></a>  </span>
<span id="cb111-8"><a href="#cb111-8"></a>df <span class="op">=</span> pd.DataFrame(data, columns <span class="op">=</span> [<span class="st">'NAME'</span>, <span class="st">'BLOOM'</span>]) </span>
<span id="cb111-9"><a href="#cb111-9"></a>df </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="85">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>NAME</th>
      <th>BLOOM</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Evert van Dijk</td>
      <td>Carmine-pink, salmon-pink streaks, stripes, fl...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Every Good Gift</td>
      <td>Red.  Flowers velvety red.  Moderate fragrance...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Evghenya</td>
      <td>Orange-pink.  75 petals.  Large, very double b...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Evita</td>
      <td>White or white blend.  None to mild fragrance....</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Evrathin</td>
      <td>Light pink. [Deep pink.]  Outer petals white. ...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Evita 2</td>
      <td>White, blush shading.  Mild, wild rose fragran...</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Please use regex methods to find all the <code>()</code> in each columns.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.18 </strong></span>Get the last two rows of <code>df</code> whose row sum is greater than 100.</p>
<div class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb112-2"><a href="#cb112-2"></a>df <span class="op">=</span> pd.DataFrame(np.random.randint(<span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">60</span>).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.19 </strong></span>The groupby object <code>df_grouped</code> is given below.</p>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb113-2"><a href="#cb113-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb113-3"><a href="#cb113-3"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'fruit'</span>: [<span class="st">'apple'</span>, <span class="st">'banana'</span>, <span class="st">'orange'</span>] <span class="op">*</span> <span class="dv">3</span>,</span>
<span id="cb113-4"><a href="#cb113-4"></a>                   <span class="st">'price'</span>: np.random.rand(<span class="dv">9</span>),</span>
<span id="cb113-5"><a href="#cb113-5"></a>                   <span class="st">'taste'</span>: np.random.randint(<span class="dv">0</span>, <span class="dv">11</span>, <span class="dv">9</span>)})</span>
<span id="cb113-6"><a href="#cb113-6"></a></span>
<span id="cb113-7"><a href="#cb113-7"></a>df_grouped <span class="op">=</span> df.groupby([<span class="st">'fruit'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>Get the group belonging to <code>apple</code> as a DataFrame.</li>
<li>Find the second largest value of <code>taste</code> for <code>banana</code>.</li>
<li>Compute the mean <code>price</code> for every <code>fruit</code>.</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.20 </strong></span>Join <code>df1</code> and <code>df2</code> by <code>fruit</code>/<code>pazham</code> and <code>weight</code>/<code>kilo</code>.</p>
<div class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1"></a>df1 <span class="op">=</span> pd.DataFrame({<span class="st">'fruit'</span>: [<span class="st">'apple'</span>, <span class="st">'banana'</span>, <span class="st">'orange'</span>] <span class="op">*</span> <span class="dv">3</span>,</span>
<span id="cb114-2"><a href="#cb114-2"></a>                    <span class="st">'weight'</span>: [<span class="st">'high'</span>, <span class="st">'medium'</span>, <span class="st">'low'</span>] <span class="op">*</span> <span class="dv">3</span>,</span>
<span id="cb114-3"><a href="#cb114-3"></a>                    <span class="st">'price'</span>: np.random.randint(<span class="dv">0</span>, <span class="dv">15</span>, <span class="dv">9</span>)})</span>
<span id="cb114-4"><a href="#cb114-4"></a></span>
<span id="cb114-5"><a href="#cb114-5"></a>df2 <span class="op">=</span> pd.DataFrame({<span class="st">'pazham'</span>: [<span class="st">'apple'</span>, <span class="st">'orange'</span>, <span class="st">'pine'</span>] <span class="op">*</span> <span class="dv">2</span>,</span>
<span id="cb114-6"><a href="#cb114-6"></a>                    <span class="st">'kilo'</span>: [<span class="st">'high'</span>, <span class="st">'low'</span>] <span class="op">*</span> <span class="dv">3</span>,</span>
<span id="cb114-7"><a href="#cb114-7"></a>                    <span class="st">'price'</span>: np.random.randint(<span class="dv">0</span>, <span class="dv">15</span>, <span class="dv">6</span>)})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="projects" class="level2" data-number="4.6">
<h2 data-number="4.6" class="anchored" data-anchor-id="projects"><span class="header-section-number">4.6</span> Projects</h2>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.21 </strong></span>Extract the valid emails from the series <code>emails</code>. The regex <code>pattern</code> for valid emails is provided as reference.</p>
<div class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb115-2"><a href="#cb115-2"></a>emails <span class="op">=</span> pd.Series([<span class="st">'buying books at amazom.com'</span>,</span>
<span id="cb115-3"><a href="#cb115-3"></a>                    <span class="st">'rameses@egypt.com'</span>,</span>
<span id="cb115-4"><a href="#cb115-4"></a>                    <span class="st">'matt@t.co'</span>,</span>
<span id="cb115-5"><a href="#cb115-5"></a>                    <span class="st">'narendra@modi.com'</span>])</span>
<span id="cb115-6"><a href="#cb115-6"></a>pattern <span class="op">=</span> <span class="st">'[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+</span><span class="ch">\\</span><span class="st">.[A-Za-z]{2,4}'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.22 </strong></span>Consider the following DataFrame.</p>
<div class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb116-2"><a href="#cb116-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb116-3"><a href="#cb116-3"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'https://raw.githubusercontent.com/selva86/datasets/master/Cars93_miss.csv'</span>, usecols<span class="op">=</span>[<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>Replace <code>NaN</code> with string <code>missing</code> in columns <code>Manufacturer</code>, <code>Model</code> and <code>Type</code>.</li>
<li>Create an index as a combination of these three columns.</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.23 </strong></span>Given the following DataFrame.</p>
<div class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb117-2"><a href="#cb117-2"></a>df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb117-3"><a href="#cb117-3"></a>    <span class="st">'name'</span>: [<span class="st">'James'</span>, <span class="st">'Jane'</span>, <span class="st">'Melissa'</span>, <span class="st">'Ed'</span>, <span class="st">'Neil'</span>],</span>
<span id="cb117-4"><a href="#cb117-4"></a>    <span class="st">'age'</span>: [<span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">32</span>, <span class="dv">67</span>, <span class="dv">43</span>],</span>
<span id="cb117-5"><a href="#cb117-5"></a>    <span class="st">'score'</span>: [<span class="st">'90%'</span>, <span class="st">'95%'</span>, <span class="st">'100%'</span>, <span class="st">'82%'</span>, <span class="st">'87%'</span>],</span>
<span id="cb117-6"><a href="#cb117-6"></a>    <span class="st">'age_missing_data'</span>: [<span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">32</span>, <span class="dv">67</span>, <span class="va">None</span>],</span>
<span id="cb117-7"><a href="#cb117-7"></a>    <span class="st">'income'</span>:[<span class="dv">100000</span>, <span class="dv">80000</span>, <span class="dv">55000</span>, <span class="dv">62000</span>, <span class="dv">120000</span>]</span>
<span id="cb117-8"><a href="#cb117-8"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Please use <code>.map</code> to create a new column <code>numeric_score</code> whose value is the number version of <code>score</code>.</li>
<li>Please use <code>.apply</code> to create a new column <code>numeric_score</code> whose value is the number version of <code>score</code>.</li>
</ul>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.24 </strong></span>From <code>ser = pd.Series(['Apple', 'Orange', 'Plan', 'Python', 'Money'])</code>, find the words that contain at least 2 vowels.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.25 </strong></span>Please download the <a href="assests/datasets/test_emails.txt">given file</a> with sample emails, and use the following code to load the file and save it to a string <code>content</code>.</p>
<div class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'assests/datasets/test_emails.txt'</span>, <span class="st">'r'</span>) <span class="im">as</span> f:</span>
<span id="cb118-2"><a href="#cb118-2"></a>    content <span class="op">=</span> f.read()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Please use regex to play with <code>content</code>.</p>
<ol type="1">
<li>Get all valid email address in <code>content</code>, from both the header part or the body part.</li>
<li>There are two emails in <code>content</code>. Please get the sender’s email and the receiver’s email from <code>content</code>.</li>
<li>Please get the sender’s name.</li>
<li>Please get the subject of each email.</li>
</ol>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 4.26 </strong></span>The following DataFrame is given.</p>
<div class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb119-2"><a href="#cb119-2"></a>df <span class="op">=</span> pd.DataFrame([<span class="st">"STD, City    State"</span>,</span>
<span id="cb119-3"><a href="#cb119-3"></a>                   <span class="st">"33, Kolkata    West Bengal"</span>,</span>
<span id="cb119-4"><a href="#cb119-4"></a>                   <span class="st">"44, Chennai    Tamil Nadu"</span>,</span>
<span id="cb119-5"><a href="#cb119-5"></a>                   <span class="st">"40, Hyderabad    Telengana"</span>,</span>
<span id="cb119-6"><a href="#cb119-6"></a>                   <span class="st">"80, Bangalore    Karnataka"</span>],</span>
<span id="cb119-7"><a href="#cb119-7"></a>                   columns<span class="op">=</span>[<span class="st">'row'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol type="1">
<li>Split the columns into a list with 3 entries.</li>
<li>Make the first row (row 0) into a header.</li>
<li>Create a new DataFrame out of the data.</li>
</ol>
</div>


<div id="refs" class="references csl-bib-body" role="doc-bibliography" style="display: none">
<div id="ref-Pra2018a" class="csl-entry" role="doc-biblioentry">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline"><span class="smallcaps">Prabhakaran</span>, S. (2018). <a href="https://www.machinelearningplus.com/python/101-pandas-exercises-python/">101 pandas exercises for data analysis</a>.</div>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../contents/3/03-.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Package: <code>numpy</code></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../contents/5/05-.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Visualization</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>